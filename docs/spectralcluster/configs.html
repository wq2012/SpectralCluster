<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.0.0"/>
    <title>spectralcluster.configs API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../spectralcluster.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;spectralcluster</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#AutoTune">AutoTune</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#AutoTune.__init__">AutoTune</a>
                        </li>
                        <li>
                                <a class="variable" href="#AutoTune.p_percentile_min">p_percentile_min</a>
                        </li>
                        <li>
                                <a class="variable" href="#AutoTune.p_percentile_max">p_percentile_max</a>
                        </li>
                        <li>
                                <a class="variable" href="#AutoTune.search_step">search_step</a>
                        </li>
                        <li>
                                <a class="variable" href="#AutoTune.search_level">search_level</a>
                        </li>
                        <li>
                                <a class="variable" href="#AutoTune.proxy">proxy</a>
                        </li>
                        <li>
                                <a class="function" href="#AutoTune.get_percentile_range">get_percentile_range</a>
                        </li>
                        <li>
                                <a class="function" href="#AutoTune.update_percentile_range">update_percentile_range</a>
                        </li>
                        <li>
                                <a class="function" href="#AutoTune.tune">tune</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ConstraintName">ConstraintName</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ConstraintName.AffinityIntegration">AffinityIntegration</a>
                        </li>
                        <li>
                                <a class="variable" href="#ConstraintName.ConstraintPropagation">ConstraintPropagation</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ConstraintOptions">ConstraintOptions</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ConstraintOptions.__init__">ConstraintOptions</a>
                        </li>
                        <li>
                                <a class="variable" href="#ConstraintOptions.constraint_name">constraint_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#ConstraintOptions.apply_before_refinement">apply_before_refinement</a>
                        </li>
                        <li>
                                <a class="variable" href="#ConstraintOptions.integration_type">integration_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#ConstraintOptions.constraint_propagation_alpha">constraint_propagation_alpha</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RefinementName">RefinementName</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#RefinementName.CropDiagonal">CropDiagonal</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementName.GaussianBlur">GaussianBlur</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementName.RowWiseThreshold">RowWiseThreshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementName.Symmetrize">Symmetrize</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementName.Diffuse">Diffuse</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementName.RowWiseNormalize">RowWiseNormalize</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#RefinementOptions">RefinementOptions</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#RefinementOptions.__init__">RefinementOptions</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.gaussian_blur_sigma">gaussian_blur_sigma</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.p_percentile">p_percentile</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.thresholding_soft_multiplier">thresholding_soft_multiplier</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.thresholding_type">thresholding_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.thresholding_with_binarization">thresholding_with_binarization</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.thresholding_preserve_diagonal">thresholding_preserve_diagonal</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.symmetrize_type">symmetrize_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#RefinementOptions.refinement_sequence">refinement_sequence</a>
                        </li>
                        <li>
                                <a class="function" href="#RefinementOptions.get_refinement_operator">get_refinement_operator</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ThresholdType">ThresholdType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#ThresholdType.RowMax">RowMax</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThresholdType.Percentile">Percentile</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SymmetrizeType">SymmetrizeType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#SymmetrizeType.Max">Max</a>
                        </li>
                        <li>
                                <a class="variable" href="#SymmetrizeType.Average">Average</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LaplacianType">LaplacianType</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#LaplacianType.Affinity">Affinity</a>
                        </li>
                        <li>
                                <a class="variable" href="#LaplacianType.Unnormalized">Unnormalized</a>
                        </li>
                        <li>
                                <a class="variable" href="#LaplacianType.RandomWalk">RandomWalk</a>
                        </li>
                        <li>
                                <a class="variable" href="#LaplacianType.GraphCut">GraphCut</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#SpectralClusterer">SpectralClusterer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#SpectralClusterer.__init__">SpectralClusterer</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.min_clusters">min_clusters</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.max_clusters">max_clusters</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.autotune">autotune</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.laplacian_type">laplacian_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.row_wise_renorm">row_wise_renorm</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.stop_eigenvalue">stop_eigenvalue</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.custom_dist">custom_dist</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.max_iter">max_iter</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.constraint_options">constraint_options</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.eigengap_type">eigengap_type</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.max_spectral_size">max_spectral_size</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.affinity_function">affinity_function</a>
                        </li>
                        <li>
                                <a class="variable" href="#SpectralClusterer.post_eigen_cluster_function">post_eigen_cluster_function</a>
                        </li>
                        <li>
                                <a class="function" href="#SpectralClusterer.predict">predict</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#ICASSP2018_REFINEMENT_SEQUENCE">ICASSP2018_REFINEMENT_SEQUENCE</a>
            </li>
            <li>
                    <a class="variable" href="#icassp2018_refinement_options">icassp2018_refinement_options</a>
            </li>
            <li>
                    <a class="variable" href="#icassp2018_clusterer">icassp2018_clusterer</a>
            </li>
            <li>
                    <a class="variable" href="#TURNTODIARIZE_REFINEMENT_SEQUENCE">TURNTODIARIZE_REFINEMENT_SEQUENCE</a>
            </li>
            <li>
                    <a class="variable" href="#turntodiarize_refinement_options">turntodiarize_refinement_options</a>
            </li>
            <li>
                    <a class="variable" href="#turntodiarize_constraint_options">turntodiarize_constraint_options</a>
            </li>
            <li>
                    <a class="variable" href="#turntodiarize_auto_tune">turntodiarize_auto_tune</a>
            </li>
            <li>
                    <a class="variable" href="#turntodiarize_clusterer">turntodiarize_clusterer</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../spectralcluster.html">spectralcluster</a><wbr>.configs    </h1>

                        <div class="docstring"><p>Example configurations.</p>
</div>

                        <input id="mod-configs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-configs-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="sd">&quot;&quot;&quot;Example configurations.&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="kn">from</span> <span class="nn">spectralcluster</span> <span class="kn">import</span> <span class="n">autotune</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">from</span> <span class="nn">spectralcluster</span> <span class="kn">import</span> <span class="n">constraint</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">from</span> <span class="nn">spectralcluster</span> <span class="kn">import</span> <span class="n">laplacian</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="kn">from</span> <span class="nn">spectralcluster</span> <span class="kn">import</span> <span class="n">refinement</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="kn">from</span> <span class="nn">spectralcluster</span> <span class="kn">import</span> <span class="n">spectral_clusterer</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="n">AutoTune</span> <span class="o">=</span> <span class="n">autotune</span><span class="o">.</span><span class="n">AutoTune</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="n">ConstraintName</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintName</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="n">ConstraintOptions</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintOptions</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="n">RefinementName</span> <span class="o">=</span> <span class="n">refinement</span><span class="o">.</span><span class="n">RefinementName</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="n">RefinementOptions</span> <span class="o">=</span> <span class="n">refinement</span><span class="o">.</span><span class="n">RefinementOptions</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="n">ThresholdType</span> <span class="o">=</span> <span class="n">refinement</span><span class="o">.</span><span class="n">ThresholdType</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="n">SymmetrizeType</span> <span class="o">=</span> <span class="n">refinement</span><span class="o">.</span><span class="n">SymmetrizeType</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="n">LaplacianType</span> <span class="o">=</span> <span class="n">laplacian</span><span class="o">.</span><span class="n">LaplacianType</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="n">SpectralClusterer</span> <span class="o">=</span> <span class="n">spectral_clusterer</span><span class="o">.</span><span class="n">SpectralClusterer</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="c1"># Configurations that are closest to the ICASSP2018 paper</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="c1"># &quot;Speaker Diarization with LSTM&quot;.</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="n">ICASSP2018_REFINEMENT_SEQUENCE</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="n">RefinementName</span><span class="o">.</span><span class="n">CropDiagonal</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="n">RefinementName</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a>    <span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseThreshold</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a>    <span class="n">RefinementName</span><span class="o">.</span><span class="n">Symmetrize</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a>    <span class="n">RefinementName</span><span class="o">.</span><span class="n">Diffuse</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a>    <span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseNormalize</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="p">]</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="n">icassp2018_refinement_options</span> <span class="o">=</span> <span class="n">RefinementOptions</span><span class="p">(</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="n">gaussian_blur_sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="n">p_percentile</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="n">thresholding_soft_multiplier</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>    <span class="n">thresholding_type</span><span class="o">=</span><span class="n">ThresholdType</span><span class="o">.</span><span class="n">RowMax</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>    <span class="n">refinement_sequence</span><span class="o">=</span><span class="n">ICASSP2018_REFINEMENT_SEQUENCE</span><span class="p">)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a><span class="n">icassp2018_clusterer</span> <span class="o">=</span> <span class="n">SpectralClusterer</span><span class="p">(</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="n">min_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="n">max_clusters</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="n">autotune</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="n">laplacian_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="n">refinement_options</span><span class="o">=</span><span class="n">icassp2018_refinement_options</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="n">custom_dist</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a><span class="c1"># Configurations of Turn-to-Diarize system using the</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a><span class="c1"># Turn + Constraint Propagation + AutoTune method described in the paper</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a><span class="c1"># &quot;Turn-to-Diarize: Online Speaker Diarization Constrained by</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a><span class="c1"># Transformer Transducer Speaker Turn Detection&quot;.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a><span class="n">TURNTODIARIZE_REFINEMENT_SEQUENCE</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>    <span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseThreshold</span><span class="p">,</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">Symmetrize</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a><span class="p">]</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a><span class="n">turntodiarize_refinement_options</span> <span class="o">=</span> <span class="n">RefinementOptions</span><span class="p">(</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>    <span class="n">thresholding_soft_multiplier</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>    <span class="n">thresholding_type</span><span class="o">=</span><span class="n">ThresholdType</span><span class="o">.</span><span class="n">Percentile</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>    <span class="n">thresholding_with_binarization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>    <span class="n">thresholding_preserve_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>    <span class="n">symmetrize_type</span><span class="o">=</span><span class="n">SymmetrizeType</span><span class="o">.</span><span class="n">Average</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>    <span class="n">refinement_sequence</span><span class="o">=</span><span class="n">TURNTODIARIZE_REFINEMENT_SEQUENCE</span><span class="p">)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a><span class="n">turntodiarize_constraint_options</span> <span class="o">=</span> <span class="n">ConstraintOptions</span><span class="p">(</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>    <span class="n">constraint_name</span><span class="o">=</span><span class="n">ConstraintName</span><span class="o">.</span><span class="n">ConstraintPropagation</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">63</span></a>    <span class="n">apply_before_refinement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">64</span></a>    <span class="n">constraint_propagation_alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos">66</span></a><span class="n">turntodiarize_auto_tune</span> <span class="o">=</span> <span class="n">AutoTune</span><span class="p">(</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">67</span></a>    <span class="n">p_percentile_min</span><span class="o">=</span><span class="mf">0.40</span><span class="p">,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">68</span></a>    <span class="n">p_percentile_max</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">69</span></a>    <span class="n">init_search_step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">70</span></a>    <span class="n">search_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">72</span></a><span class="n">turntodiarize_clusterer</span> <span class="o">=</span> <span class="n">SpectralClusterer</span><span class="p">(</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">73</span></a>    <span class="n">min_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">74</span></a>    <span class="n">max_clusters</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">75</span></a>    <span class="n">refinement_options</span><span class="o">=</span><span class="n">turntodiarize_refinement_options</span><span class="p">,</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">76</span></a>    <span class="n">constraint_options</span><span class="o">=</span><span class="n">turntodiarize_constraint_options</span><span class="p">,</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">77</span></a>    <span class="n">autotune</span><span class="o">=</span><span class="n">turntodiarize_auto_tune</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">78</span></a>    <span class="n">laplacian_type</span><span class="o">=</span><span class="n">LaplacianType</span><span class="o">.</span><span class="n">GraphCut</span><span class="p">,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">79</span></a>    <span class="n">row_wise_renorm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">80</span></a>    <span class="n">custom_dist</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="AutoTune">
                            <input id="AutoTune-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AutoTune</span>:

                <label class="view-source-button" for="AutoTune-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoTune"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoTune-27"><a href="#AutoTune-27"><span class="linenos"> 27</span></a><span class="k">class</span> <span class="nc">AutoTune</span><span class="p">:</span>
</span><span id="AutoTune-28"><a href="#AutoTune-28"><span class="linenos"> 28</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;AutoTune Class.</span>
</span><span id="AutoTune-29"><a href="#AutoTune-29"><span class="linenos"> 29</span></a>
</span><span id="AutoTune-30"><a href="#AutoTune-30"><span class="linenos"> 30</span></a><span class="sd">  This auto-tuning method is implemented based on this paper:</span>
</span><span id="AutoTune-31"><a href="#AutoTune-31"><span class="linenos"> 31</span></a><span class="sd">  Park, Tae Jin, et al. &quot;Auto-tuning spectral clustering for speaker</span>
</span><span id="AutoTune-32"><a href="#AutoTune-32"><span class="linenos"> 32</span></a><span class="sd">  diarization using normalized maximum eigengap.&quot; IEEE Signal Processing Letter</span>
</span><span id="AutoTune-33"><a href="#AutoTune-33"><span class="linenos"> 33</span></a><span class="sd">  2019.</span>
</span><span id="AutoTune-34"><a href="#AutoTune-34"><span class="linenos"> 34</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="AutoTune-35"><a href="#AutoTune-35"><span class="linenos"> 35</span></a>
</span><span id="AutoTune-36"><a href="#AutoTune-36"><span class="linenos"> 36</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="AutoTune-37"><a href="#AutoTune-37"><span class="linenos"> 37</span></a>               <span class="n">p_percentile_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.60</span><span class="p">,</span>
</span><span id="AutoTune-38"><a href="#AutoTune-38"><span class="linenos"> 38</span></a>               <span class="n">p_percentile_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
</span><span id="AutoTune-39"><a href="#AutoTune-39"><span class="linenos"> 39</span></a>               <span class="n">init_search_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
</span><span id="AutoTune-40"><a href="#AutoTune-40"><span class="linenos"> 40</span></a>               <span class="n">search_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="AutoTune-41"><a href="#AutoTune-41"><span class="linenos"> 41</span></a>               <span class="n">proxy</span><span class="p">:</span> <span class="n">AutoTuneProxy</span> <span class="o">=</span> <span class="n">AutoTuneProxy</span><span class="o">.</span><span class="n">PercentileSqrtOverNME</span><span class="p">):</span>
</span><span id="AutoTune-42"><a href="#AutoTune-42"><span class="linenos"> 42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization of the autotune arguments.</span>
</span><span id="AutoTune-43"><a href="#AutoTune-43"><span class="linenos"> 43</span></a>
</span><span id="AutoTune-44"><a href="#AutoTune-44"><span class="linenos"> 44</span></a><span class="sd">    Args:</span>
</span><span id="AutoTune-45"><a href="#AutoTune-45"><span class="linenos"> 45</span></a><span class="sd">      p_percentile_min: minimum value of p_percentile</span>
</span><span id="AutoTune-46"><a href="#AutoTune-46"><span class="linenos"> 46</span></a><span class="sd">      p_percentile_max: maximum value of p_percentile</span>
</span><span id="AutoTune-47"><a href="#AutoTune-47"><span class="linenos"> 47</span></a><span class="sd">      init_search_step: initial search step size for auto-tuning</span>
</span><span id="AutoTune-48"><a href="#AutoTune-48"><span class="linenos"> 48</span></a><span class="sd">      search_level: hierarchical search level for auto-tuning</span>
</span><span id="AutoTune-49"><a href="#AutoTune-49"><span class="linenos"> 49</span></a><span class="sd">      proxy: which proxy to minimize for auto-tuning</span>
</span><span id="AutoTune-50"><a href="#AutoTune-50"><span class="linenos"> 50</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AutoTune-51"><a href="#AutoTune-51"><span class="linenos"> 51</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span> <span class="o">=</span> <span class="n">p_percentile_min</span>
</span><span id="AutoTune-52"><a href="#AutoTune-52"><span class="linenos"> 52</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span> <span class="o">=</span> <span class="n">p_percentile_max</span>
</span><span id="AutoTune-53"><a href="#AutoTune-53"><span class="linenos"> 53</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">=</span> <span class="n">init_search_step</span>
</span><span id="AutoTune-54"><a href="#AutoTune-54"><span class="linenos"> 54</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">search_level</span> <span class="o">=</span> <span class="n">search_level</span>
</span><span id="AutoTune-55"><a href="#AutoTune-55"><span class="linenos"> 55</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proxy</span><span class="p">,</span> <span class="n">AutoTuneProxy</span><span class="p">):</span>
</span><span id="AutoTune-56"><a href="#AutoTune-56"><span class="linenos"> 56</span></a>      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;proxy must be an instance of AutoTuneProxy&quot;</span><span class="p">)</span>
</span><span id="AutoTune-57"><a href="#AutoTune-57"><span class="linenos"> 57</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">proxy</span> <span class="o">=</span> <span class="n">proxy</span>
</span><span id="AutoTune-58"><a href="#AutoTune-58"><span class="linenos"> 58</span></a>
</span><span id="AutoTune-59"><a href="#AutoTune-59"><span class="linenos"> 59</span></a>  <span class="k">def</span> <span class="nf">get_percentile_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="AutoTune-60"><a href="#AutoTune-60"><span class="linenos"> 60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current percentile search range.&quot;&quot;&quot;</span>
</span><span id="AutoTune-61"><a href="#AutoTune-61"><span class="linenos"> 61</span></a>    <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
</span><span id="AutoTune-62"><a href="#AutoTune-62"><span class="linenos"> 62</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="AutoTune-63"><a href="#AutoTune-63"><span class="linenos"> 63</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span><span class="p">))</span>
</span><span id="AutoTune-64"><a href="#AutoTune-64"><span class="linenos"> 64</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="AutoTune-65"><a href="#AutoTune-65"><span class="linenos"> 65</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">))</span>
</span><span id="AutoTune-66"><a href="#AutoTune-66"><span class="linenos"> 66</span></a>
</span><span id="AutoTune-67"><a href="#AutoTune-67"><span class="linenos"> 67</span></a>  <span class="k">def</span> <span class="nf">update_percentile_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="AutoTune-68"><a href="#AutoTune-68"><span class="linenos"> 68</span></a>                              <span class="n">p_percentile_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="AutoTune-69"><a href="#AutoTune-69"><span class="linenos"> 69</span></a>                              <span class="n">p_percentile_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="AutoTune-70"><a href="#AutoTune-70"><span class="linenos"> 70</span></a>                              <span class="n">search_step</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="AutoTune-71"><a href="#AutoTune-71"><span class="linenos"> 71</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the percentile search range.&quot;&quot;&quot;</span>
</span><span id="AutoTune-72"><a href="#AutoTune-72"><span class="linenos"> 72</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span> <span class="o">=</span> <span class="n">p_percentile_min</span>
</span><span id="AutoTune-73"><a href="#AutoTune-73"><span class="linenos"> 73</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span> <span class="o">=</span> <span class="n">p_percentile_max</span>
</span><span id="AutoTune-74"><a href="#AutoTune-74"><span class="linenos"> 74</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">=</span> <span class="n">search_step</span>
</span><span id="AutoTune-75"><a href="#AutoTune-75"><span class="linenos"> 75</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_percentile_range</span><span class="p">()</span>
</span><span id="AutoTune-76"><a href="#AutoTune-76"><span class="linenos"> 76</span></a>
</span><span id="AutoTune-77"><a href="#AutoTune-77"><span class="linenos"> 77</span></a>  <span class="k">def</span> <span class="nf">tune</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p_percentile_to_ratio</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
</span><span id="AutoTune-78"><a href="#AutoTune-78"><span class="linenos"> 78</span></a>      <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]):</span>
</span><span id="AutoTune-79"><a href="#AutoTune-79"><span class="linenos"> 79</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tune the hyper-parameter p_percentile.</span>
</span><span id="AutoTune-80"><a href="#AutoTune-80"><span class="linenos"> 80</span></a>
</span><span id="AutoTune-81"><a href="#AutoTune-81"><span class="linenos"> 81</span></a><span class="sd">    Use a proxy ratio of DER to tune the hyper-parameter p_percentile. It also</span>
</span><span id="AutoTune-82"><a href="#AutoTune-82"><span class="linenos"> 82</span></a><span class="sd">    performs some side work to do affinity refinement, eigen decomposition, and</span>
</span><span id="AutoTune-83"><a href="#AutoTune-83"><span class="linenos"> 83</span></a><span class="sd">    estimate the number of clusters.</span>
</span><span id="AutoTune-84"><a href="#AutoTune-84"><span class="linenos"> 84</span></a>
</span><span id="AutoTune-85"><a href="#AutoTune-85"><span class="linenos"> 85</span></a><span class="sd">    Args:</span>
</span><span id="AutoTune-86"><a href="#AutoTune-86"><span class="linenos"> 86</span></a><span class="sd">      p_percentile_to_ratio: a callable to compute the `ratio` given a</span>
</span><span id="AutoTune-87"><a href="#AutoTune-87"><span class="linenos"> 87</span></a><span class="sd">        `p_percentile` value</span>
</span><span id="AutoTune-88"><a href="#AutoTune-88"><span class="linenos"> 88</span></a>
</span><span id="AutoTune-89"><a href="#AutoTune-89"><span class="linenos"> 89</span></a><span class="sd">    Returns:</span>
</span><span id="AutoTune-90"><a href="#AutoTune-90"><span class="linenos"> 90</span></a><span class="sd">      eigenvectors: sorted eigenvectors. numpy array of shape</span>
</span><span id="AutoTune-91"><a href="#AutoTune-91"><span class="linenos"> 91</span></a><span class="sd">      (n_samples, n_samples)</span>
</span><span id="AutoTune-92"><a href="#AutoTune-92"><span class="linenos"> 92</span></a><span class="sd">      n_clusters: number of clusters as an integer</span>
</span><span id="AutoTune-93"><a href="#AutoTune-93"><span class="linenos"> 93</span></a><span class="sd">      best_p_percentile: p_percentile value that minimizes the ratio</span>
</span><span id="AutoTune-94"><a href="#AutoTune-94"><span class="linenos"> 94</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AutoTune-95"><a href="#AutoTune-95"><span class="linenos"> 95</span></a>    <span class="n">p_percentile_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_percentile_range</span><span class="p">()</span>
</span><span id="AutoTune-96"><a href="#AutoTune-96"><span class="linenos"> 96</span></a>    <span class="n">searched</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="AutoTune-97"><a href="#AutoTune-97"><span class="linenos"> 97</span></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_level</span><span class="p">):</span>
</span><span id="AutoTune-98"><a href="#AutoTune-98"><span class="linenos"> 98</span></a>      <span class="n">min_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</span><span id="AutoTune-99"><a href="#AutoTune-99"><span class="linenos"> 99</span></a>      <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">p_percentile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p_percentile_range</span><span class="p">):</span>
</span><span id="AutoTune-100"><a href="#AutoTune-100"><span class="linenos">100</span></a>        <span class="k">if</span> <span class="n">p_percentile</span> <span class="ow">in</span> <span class="n">searched</span><span class="p">:</span>
</span><span id="AutoTune-101"><a href="#AutoTune-101"><span class="linenos">101</span></a>          <span class="k">continue</span>
</span><span id="AutoTune-102"><a href="#AutoTune-102"><span class="linenos">102</span></a>        <span class="c1"># ratio is a proxy value of DER. We minimize this ratio</span>
</span><span id="AutoTune-103"><a href="#AutoTune-103"><span class="linenos">103</span></a>        <span class="c1"># to find a good p_percentile</span>
</span><span id="AutoTune-104"><a href="#AutoTune-104"><span class="linenos">104</span></a>        <span class="n">ratio</span><span class="p">,</span> <span class="n">eigenvectors_p</span><span class="p">,</span> <span class="n">n_clusters_p</span> <span class="o">=</span> <span class="n">p_percentile_to_ratio</span><span class="p">(</span>
</span><span id="AutoTune-105"><a href="#AutoTune-105"><span class="linenos">105</span></a>            <span class="n">p_percentile</span><span class="p">)</span>
</span><span id="AutoTune-106"><a href="#AutoTune-106"><span class="linenos">106</span></a>        <span class="n">searched</span><span class="p">[</span><span class="n">p_percentile</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratio</span>
</span><span id="AutoTune-107"><a href="#AutoTune-107"><span class="linenos">107</span></a>        <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="n">min_ratio</span><span class="p">:</span>
</span><span id="AutoTune-108"><a href="#AutoTune-108"><span class="linenos">108</span></a>          <span class="n">min_ratio</span> <span class="o">=</span> <span class="n">ratio</span>
</span><span id="AutoTune-109"><a href="#AutoTune-109"><span class="linenos">109</span></a>          <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">eigenvectors_p</span>
</span><span id="AutoTune-110"><a href="#AutoTune-110"><span class="linenos">110</span></a>          <span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters_p</span>
</span><span id="AutoTune-111"><a href="#AutoTune-111"><span class="linenos">111</span></a>          <span class="n">best_p_percentile</span> <span class="o">=</span> <span class="n">p_percentile</span>
</span><span id="AutoTune-112"><a href="#AutoTune-112"><span class="linenos">112</span></a>          <span class="n">best_p_percentile_index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="AutoTune-113"><a href="#AutoTune-113"><span class="linenos">113</span></a>      <span class="c1"># If the search range is not valid or search step is too small, we stop</span>
</span><span id="AutoTune-114"><a href="#AutoTune-114"><span class="linenos">114</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">p_percentile_range</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="AutoTune-115"><a href="#AutoTune-115"><span class="linenos">115</span></a>          <span class="n">p_percentile_range</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">&lt;</span> <span class="n">MIN_SEARCH_STEP</span><span class="p">:</span>
</span><span id="AutoTune-116"><a href="#AutoTune-116"><span class="linenos">116</span></a>        <span class="k">break</span>
</span><span id="AutoTune-117"><a href="#AutoTune-117"><span class="linenos">117</span></a>      <span class="c1"># Update the search range of p_percentile.</span>
</span><span id="AutoTune-118"><a href="#AutoTune-118"><span class="linenos">118</span></a>      <span class="c1"># We search again from `start_index` position to `end_index` position</span>
</span><span id="AutoTune-119"><a href="#AutoTune-119"><span class="linenos">119</span></a>      <span class="c1"># which is `local_search_dist` away from the found</span>
</span><span id="AutoTune-120"><a href="#AutoTune-120"><span class="linenos">120</span></a>      <span class="c1"># `best_p_percentile_index` position. `search_step` is reduced to half of</span>
</span><span id="AutoTune-121"><a href="#AutoTune-121"><span class="linenos">121</span></a>      <span class="c1"># the original size</span>
</span><span id="AutoTune-122"><a href="#AutoTune-122"><span class="linenos">122</span></a>      <span class="n">local_search_dist</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_percentile_range</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="AutoTune-123"><a href="#AutoTune-123"><span class="linenos">123</span></a>      <span class="n">start_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">best_p_percentile_index</span> <span class="o">-</span> <span class="n">local_search_dist</span><span class="p">)</span>
</span><span id="AutoTune-124"><a href="#AutoTune-124"><span class="linenos">124</span></a>      <span class="n">end_index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
</span><span id="AutoTune-125"><a href="#AutoTune-125"><span class="linenos">125</span></a>          <span class="nb">len</span><span class="p">(</span><span class="n">p_percentile_range</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="AutoTune-126"><a href="#AutoTune-126"><span class="linenos">126</span></a>          <span class="n">best_p_percentile_index</span> <span class="o">+</span> <span class="n">local_search_dist</span><span class="p">)</span>
</span><span id="AutoTune-127"><a href="#AutoTune-127"><span class="linenos">127</span></a>      <span class="n">p_percentile_min</span> <span class="o">=</span> <span class="n">p_percentile_range</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span>
</span><span id="AutoTune-128"><a href="#AutoTune-128"><span class="linenos">128</span></a>      <span class="n">p_percentile_max</span> <span class="o">=</span> <span class="n">p_percentile_range</span><span class="p">[</span><span class="n">end_index</span><span class="p">]</span>
</span><span id="AutoTune-129"><a href="#AutoTune-129"><span class="linenos">129</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="AutoTune-130"><a href="#AutoTune-130"><span class="linenos">130</span></a>      <span class="n">p_percentile_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_percentile_range</span><span class="p">(</span><span class="n">p_percentile_min</span><span class="p">,</span>
</span><span id="AutoTune-131"><a href="#AutoTune-131"><span class="linenos">131</span></a>                                                        <span class="n">p_percentile_max</span><span class="p">,</span>
</span><span id="AutoTune-132"><a href="#AutoTune-132"><span class="linenos">132</span></a>                                                        <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span><span class="p">)</span>
</span><span id="AutoTune-133"><a href="#AutoTune-133"><span class="linenos">133</span></a>    <span class="k">return</span> <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">best_p_percentile</span>
</span></pre></div>


            <div class="docstring"><p>AutoTune Class.</p>

<p>This auto-tuning method is implemented based on this paper:
Park, Tae Jin, et al. "Auto-tuning spectral clustering for speaker
diarization using normalized maximum eigengap." IEEE Signal Processing Letter
2019.</p>
</div>


                            <div id="AutoTune.__init__" class="classattr">
                                        <input id="AutoTune.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">AutoTune</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">p_percentile_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span>,</span><span class="param">	<span class="n">p_percentile_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span>,</span><span class="param">	<span class="n">init_search_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>,</span><span class="param">	<span class="n">search_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">proxy</span><span class="p">:</span> <span class="n"><a href="autotune.html#AutoTuneProxy">spectralcluster.autotune.AutoTuneProxy</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">AutoTuneProxy</span><span class="o">.</span><span class="n">PercentileSqrtOverNME</span><span class="p">:</span> <span class="mi">2</span><span class="o">&gt;</span></span>)</span>

                <label class="view-source-button" for="AutoTune.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoTune.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoTune.__init__-36"><a href="#AutoTune.__init__-36"><span class="linenos">36</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="AutoTune.__init__-37"><a href="#AutoTune.__init__-37"><span class="linenos">37</span></a>               <span class="n">p_percentile_min</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.60</span><span class="p">,</span>
</span><span id="AutoTune.__init__-38"><a href="#AutoTune.__init__-38"><span class="linenos">38</span></a>               <span class="n">p_percentile_max</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
</span><span id="AutoTune.__init__-39"><a href="#AutoTune.__init__-39"><span class="linenos">39</span></a>               <span class="n">init_search_step</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
</span><span id="AutoTune.__init__-40"><a href="#AutoTune.__init__-40"><span class="linenos">40</span></a>               <span class="n">search_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="AutoTune.__init__-41"><a href="#AutoTune.__init__-41"><span class="linenos">41</span></a>               <span class="n">proxy</span><span class="p">:</span> <span class="n">AutoTuneProxy</span> <span class="o">=</span> <span class="n">AutoTuneProxy</span><span class="o">.</span><span class="n">PercentileSqrtOverNME</span><span class="p">):</span>
</span><span id="AutoTune.__init__-42"><a href="#AutoTune.__init__-42"><span class="linenos">42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialization of the autotune arguments.</span>
</span><span id="AutoTune.__init__-43"><a href="#AutoTune.__init__-43"><span class="linenos">43</span></a>
</span><span id="AutoTune.__init__-44"><a href="#AutoTune.__init__-44"><span class="linenos">44</span></a><span class="sd">    Args:</span>
</span><span id="AutoTune.__init__-45"><a href="#AutoTune.__init__-45"><span class="linenos">45</span></a><span class="sd">      p_percentile_min: minimum value of p_percentile</span>
</span><span id="AutoTune.__init__-46"><a href="#AutoTune.__init__-46"><span class="linenos">46</span></a><span class="sd">      p_percentile_max: maximum value of p_percentile</span>
</span><span id="AutoTune.__init__-47"><a href="#AutoTune.__init__-47"><span class="linenos">47</span></a><span class="sd">      init_search_step: initial search step size for auto-tuning</span>
</span><span id="AutoTune.__init__-48"><a href="#AutoTune.__init__-48"><span class="linenos">48</span></a><span class="sd">      search_level: hierarchical search level for auto-tuning</span>
</span><span id="AutoTune.__init__-49"><a href="#AutoTune.__init__-49"><span class="linenos">49</span></a><span class="sd">      proxy: which proxy to minimize for auto-tuning</span>
</span><span id="AutoTune.__init__-50"><a href="#AutoTune.__init__-50"><span class="linenos">50</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AutoTune.__init__-51"><a href="#AutoTune.__init__-51"><span class="linenos">51</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span> <span class="o">=</span> <span class="n">p_percentile_min</span>
</span><span id="AutoTune.__init__-52"><a href="#AutoTune.__init__-52"><span class="linenos">52</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span> <span class="o">=</span> <span class="n">p_percentile_max</span>
</span><span id="AutoTune.__init__-53"><a href="#AutoTune.__init__-53"><span class="linenos">53</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">=</span> <span class="n">init_search_step</span>
</span><span id="AutoTune.__init__-54"><a href="#AutoTune.__init__-54"><span class="linenos">54</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">search_level</span> <span class="o">=</span> <span class="n">search_level</span>
</span><span id="AutoTune.__init__-55"><a href="#AutoTune.__init__-55"><span class="linenos">55</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proxy</span><span class="p">,</span> <span class="n">AutoTuneProxy</span><span class="p">):</span>
</span><span id="AutoTune.__init__-56"><a href="#AutoTune.__init__-56"><span class="linenos">56</span></a>      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;proxy must be an instance of AutoTuneProxy&quot;</span><span class="p">)</span>
</span><span id="AutoTune.__init__-57"><a href="#AutoTune.__init__-57"><span class="linenos">57</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">proxy</span> <span class="o">=</span> <span class="n">proxy</span>
</span></pre></div>


            <div class="docstring"><p>Initialization of the autotune arguments.</p>

<p>Args:
  p_percentile_min: minimum value of p_percentile
  p_percentile_max: maximum value of p_percentile
  init_search_step: initial search step size for auto-tuning
  search_level: hierarchical search level for auto-tuning
  proxy: which proxy to minimize for auto-tuning</p>
</div>


                            </div>
                            <div id="AutoTune.p_percentile_min" class="classattr">
                                <div class="attr variable">
            <span class="name">p_percentile_min</span>

        
    </div>
    <a class="headerlink" href="#AutoTune.p_percentile_min"></a>
    
    

                            </div>
                            <div id="AutoTune.p_percentile_max" class="classattr">
                                <div class="attr variable">
            <span class="name">p_percentile_max</span>

        
    </div>
    <a class="headerlink" href="#AutoTune.p_percentile_max"></a>
    
    

                            </div>
                            <div id="AutoTune.search_step" class="classattr">
                                <div class="attr variable">
            <span class="name">search_step</span>

        
    </div>
    <a class="headerlink" href="#AutoTune.search_step"></a>
    
    

                            </div>
                            <div id="AutoTune.search_level" class="classattr">
                                <div class="attr variable">
            <span class="name">search_level</span>

        
    </div>
    <a class="headerlink" href="#AutoTune.search_level"></a>
    
    

                            </div>
                            <div id="AutoTune.proxy" class="classattr">
                                <div class="attr variable">
            <span class="name">proxy</span>

        
    </div>
    <a class="headerlink" href="#AutoTune.proxy"></a>
    
    

                            </div>
                            <div id="AutoTune.get_percentile_range" class="classattr">
                                        <input id="AutoTune.get_percentile_range-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_percentile_range</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="AutoTune.get_percentile_range-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoTune.get_percentile_range"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoTune.get_percentile_range-59"><a href="#AutoTune.get_percentile_range-59"><span class="linenos">59</span></a>  <span class="k">def</span> <span class="nf">get_percentile_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="AutoTune.get_percentile_range-60"><a href="#AutoTune.get_percentile_range-60"><span class="linenos">60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current percentile search range.&quot;&quot;&quot;</span>
</span><span id="AutoTune.get_percentile_range-61"><a href="#AutoTune.get_percentile_range-61"><span class="linenos">61</span></a>    <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
</span><span id="AutoTune.get_percentile_range-62"><a href="#AutoTune.get_percentile_range-62"><span class="linenos">62</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
</span><span id="AutoTune.get_percentile_range-63"><a href="#AutoTune.get_percentile_range-63"><span class="linenos">63</span></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span><span class="p">))</span>
</span><span id="AutoTune.get_percentile_range-64"><a href="#AutoTune.get_percentile_range-64"><span class="linenos">64</span></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="AutoTune.get_percentile_range-65"><a href="#AutoTune.get_percentile_range-65"><span class="linenos">65</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span><span class="p">,</span> <span class="n">num_steps</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get the current percentile search range.</p>
</div>


                            </div>
                            <div id="AutoTune.update_percentile_range" class="classattr">
                                        <input id="AutoTune.update_percentile_range-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_percentile_range</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">p_percentile_min</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">p_percentile_max</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">search_step</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="AutoTune.update_percentile_range-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoTune.update_percentile_range"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoTune.update_percentile_range-67"><a href="#AutoTune.update_percentile_range-67"><span class="linenos">67</span></a>  <span class="k">def</span> <span class="nf">update_percentile_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="AutoTune.update_percentile_range-68"><a href="#AutoTune.update_percentile_range-68"><span class="linenos">68</span></a>                              <span class="n">p_percentile_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="AutoTune.update_percentile_range-69"><a href="#AutoTune.update_percentile_range-69"><span class="linenos">69</span></a>                              <span class="n">p_percentile_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="AutoTune.update_percentile_range-70"><a href="#AutoTune.update_percentile_range-70"><span class="linenos">70</span></a>                              <span class="n">search_step</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
</span><span id="AutoTune.update_percentile_range-71"><a href="#AutoTune.update_percentile_range-71"><span class="linenos">71</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the percentile search range.&quot;&quot;&quot;</span>
</span><span id="AutoTune.update_percentile_range-72"><a href="#AutoTune.update_percentile_range-72"><span class="linenos">72</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_min</span> <span class="o">=</span> <span class="n">p_percentile_min</span>
</span><span id="AutoTune.update_percentile_range-73"><a href="#AutoTune.update_percentile_range-73"><span class="linenos">73</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">p_percentile_max</span> <span class="o">=</span> <span class="n">p_percentile_max</span>
</span><span id="AutoTune.update_percentile_range-74"><a href="#AutoTune.update_percentile_range-74"><span class="linenos">74</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">=</span> <span class="n">search_step</span>
</span><span id="AutoTune.update_percentile_range-75"><a href="#AutoTune.update_percentile_range-75"><span class="linenos">75</span></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_percentile_range</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Update the percentile search range.</p>
</div>


                            </div>
                            <div id="AutoTune.tune" class="classattr">
                                        <input id="AutoTune.tune-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tune</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">p_percentile_to_ratio</span><span class="p">:</span> <span class="n">Callable</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="AutoTune.tune-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AutoTune.tune"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AutoTune.tune-77"><a href="#AutoTune.tune-77"><span class="linenos"> 77</span></a>  <span class="k">def</span> <span class="nf">tune</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p_percentile_to_ratio</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
</span><span id="AutoTune.tune-78"><a href="#AutoTune.tune-78"><span class="linenos"> 78</span></a>      <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]):</span>
</span><span id="AutoTune.tune-79"><a href="#AutoTune.tune-79"><span class="linenos"> 79</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Tune the hyper-parameter p_percentile.</span>
</span><span id="AutoTune.tune-80"><a href="#AutoTune.tune-80"><span class="linenos"> 80</span></a>
</span><span id="AutoTune.tune-81"><a href="#AutoTune.tune-81"><span class="linenos"> 81</span></a><span class="sd">    Use a proxy ratio of DER to tune the hyper-parameter p_percentile. It also</span>
</span><span id="AutoTune.tune-82"><a href="#AutoTune.tune-82"><span class="linenos"> 82</span></a><span class="sd">    performs some side work to do affinity refinement, eigen decomposition, and</span>
</span><span id="AutoTune.tune-83"><a href="#AutoTune.tune-83"><span class="linenos"> 83</span></a><span class="sd">    estimate the number of clusters.</span>
</span><span id="AutoTune.tune-84"><a href="#AutoTune.tune-84"><span class="linenos"> 84</span></a>
</span><span id="AutoTune.tune-85"><a href="#AutoTune.tune-85"><span class="linenos"> 85</span></a><span class="sd">    Args:</span>
</span><span id="AutoTune.tune-86"><a href="#AutoTune.tune-86"><span class="linenos"> 86</span></a><span class="sd">      p_percentile_to_ratio: a callable to compute the `ratio` given a</span>
</span><span id="AutoTune.tune-87"><a href="#AutoTune.tune-87"><span class="linenos"> 87</span></a><span class="sd">        `p_percentile` value</span>
</span><span id="AutoTune.tune-88"><a href="#AutoTune.tune-88"><span class="linenos"> 88</span></a>
</span><span id="AutoTune.tune-89"><a href="#AutoTune.tune-89"><span class="linenos"> 89</span></a><span class="sd">    Returns:</span>
</span><span id="AutoTune.tune-90"><a href="#AutoTune.tune-90"><span class="linenos"> 90</span></a><span class="sd">      eigenvectors: sorted eigenvectors. numpy array of shape</span>
</span><span id="AutoTune.tune-91"><a href="#AutoTune.tune-91"><span class="linenos"> 91</span></a><span class="sd">      (n_samples, n_samples)</span>
</span><span id="AutoTune.tune-92"><a href="#AutoTune.tune-92"><span class="linenos"> 92</span></a><span class="sd">      n_clusters: number of clusters as an integer</span>
</span><span id="AutoTune.tune-93"><a href="#AutoTune.tune-93"><span class="linenos"> 93</span></a><span class="sd">      best_p_percentile: p_percentile value that minimizes the ratio</span>
</span><span id="AutoTune.tune-94"><a href="#AutoTune.tune-94"><span class="linenos"> 94</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AutoTune.tune-95"><a href="#AutoTune.tune-95"><span class="linenos"> 95</span></a>    <span class="n">p_percentile_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_percentile_range</span><span class="p">()</span>
</span><span id="AutoTune.tune-96"><a href="#AutoTune.tune-96"><span class="linenos"> 96</span></a>    <span class="n">searched</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="AutoTune.tune-97"><a href="#AutoTune.tune-97"><span class="linenos"> 97</span></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_level</span><span class="p">):</span>
</span><span id="AutoTune.tune-98"><a href="#AutoTune.tune-98"><span class="linenos"> 98</span></a>      <span class="n">min_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</span><span id="AutoTune.tune-99"><a href="#AutoTune.tune-99"><span class="linenos"> 99</span></a>      <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">p_percentile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p_percentile_range</span><span class="p">):</span>
</span><span id="AutoTune.tune-100"><a href="#AutoTune.tune-100"><span class="linenos">100</span></a>        <span class="k">if</span> <span class="n">p_percentile</span> <span class="ow">in</span> <span class="n">searched</span><span class="p">:</span>
</span><span id="AutoTune.tune-101"><a href="#AutoTune.tune-101"><span class="linenos">101</span></a>          <span class="k">continue</span>
</span><span id="AutoTune.tune-102"><a href="#AutoTune.tune-102"><span class="linenos">102</span></a>        <span class="c1"># ratio is a proxy value of DER. We minimize this ratio</span>
</span><span id="AutoTune.tune-103"><a href="#AutoTune.tune-103"><span class="linenos">103</span></a>        <span class="c1"># to find a good p_percentile</span>
</span><span id="AutoTune.tune-104"><a href="#AutoTune.tune-104"><span class="linenos">104</span></a>        <span class="n">ratio</span><span class="p">,</span> <span class="n">eigenvectors_p</span><span class="p">,</span> <span class="n">n_clusters_p</span> <span class="o">=</span> <span class="n">p_percentile_to_ratio</span><span class="p">(</span>
</span><span id="AutoTune.tune-105"><a href="#AutoTune.tune-105"><span class="linenos">105</span></a>            <span class="n">p_percentile</span><span class="p">)</span>
</span><span id="AutoTune.tune-106"><a href="#AutoTune.tune-106"><span class="linenos">106</span></a>        <span class="n">searched</span><span class="p">[</span><span class="n">p_percentile</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratio</span>
</span><span id="AutoTune.tune-107"><a href="#AutoTune.tune-107"><span class="linenos">107</span></a>        <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="n">min_ratio</span><span class="p">:</span>
</span><span id="AutoTune.tune-108"><a href="#AutoTune.tune-108"><span class="linenos">108</span></a>          <span class="n">min_ratio</span> <span class="o">=</span> <span class="n">ratio</span>
</span><span id="AutoTune.tune-109"><a href="#AutoTune.tune-109"><span class="linenos">109</span></a>          <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">eigenvectors_p</span>
</span><span id="AutoTune.tune-110"><a href="#AutoTune.tune-110"><span class="linenos">110</span></a>          <span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters_p</span>
</span><span id="AutoTune.tune-111"><a href="#AutoTune.tune-111"><span class="linenos">111</span></a>          <span class="n">best_p_percentile</span> <span class="o">=</span> <span class="n">p_percentile</span>
</span><span id="AutoTune.tune-112"><a href="#AutoTune.tune-112"><span class="linenos">112</span></a>          <span class="n">best_p_percentile_index</span> <span class="o">=</span> <span class="n">index</span>
</span><span id="AutoTune.tune-113"><a href="#AutoTune.tune-113"><span class="linenos">113</span></a>      <span class="c1"># If the search range is not valid or search step is too small, we stop</span>
</span><span id="AutoTune.tune-114"><a href="#AutoTune.tune-114"><span class="linenos">114</span></a>      <span class="k">if</span> <span class="ow">not</span> <span class="n">p_percentile_range</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="AutoTune.tune-115"><a href="#AutoTune.tune-115"><span class="linenos">115</span></a>          <span class="n">p_percentile_range</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">&lt;</span> <span class="n">MIN_SEARCH_STEP</span><span class="p">:</span>
</span><span id="AutoTune.tune-116"><a href="#AutoTune.tune-116"><span class="linenos">116</span></a>        <span class="k">break</span>
</span><span id="AutoTune.tune-117"><a href="#AutoTune.tune-117"><span class="linenos">117</span></a>      <span class="c1"># Update the search range of p_percentile.</span>
</span><span id="AutoTune.tune-118"><a href="#AutoTune.tune-118"><span class="linenos">118</span></a>      <span class="c1"># We search again from `start_index` position to `end_index` position</span>
</span><span id="AutoTune.tune-119"><a href="#AutoTune.tune-119"><span class="linenos">119</span></a>      <span class="c1"># which is `local_search_dist` away from the found</span>
</span><span id="AutoTune.tune-120"><a href="#AutoTune.tune-120"><span class="linenos">120</span></a>      <span class="c1"># `best_p_percentile_index` position. `search_step` is reduced to half of</span>
</span><span id="AutoTune.tune-121"><a href="#AutoTune.tune-121"><span class="linenos">121</span></a>      <span class="c1"># the original size</span>
</span><span id="AutoTune.tune-122"><a href="#AutoTune.tune-122"><span class="linenos">122</span></a>      <span class="n">local_search_dist</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_percentile_range</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">)</span>
</span><span id="AutoTune.tune-123"><a href="#AutoTune.tune-123"><span class="linenos">123</span></a>      <span class="n">start_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">best_p_percentile_index</span> <span class="o">-</span> <span class="n">local_search_dist</span><span class="p">)</span>
</span><span id="AutoTune.tune-124"><a href="#AutoTune.tune-124"><span class="linenos">124</span></a>      <span class="n">end_index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
</span><span id="AutoTune.tune-125"><a href="#AutoTune.tune-125"><span class="linenos">125</span></a>          <span class="nb">len</span><span class="p">(</span><span class="n">p_percentile_range</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="AutoTune.tune-126"><a href="#AutoTune.tune-126"><span class="linenos">126</span></a>          <span class="n">best_p_percentile_index</span> <span class="o">+</span> <span class="n">local_search_dist</span><span class="p">)</span>
</span><span id="AutoTune.tune-127"><a href="#AutoTune.tune-127"><span class="linenos">127</span></a>      <span class="n">p_percentile_min</span> <span class="o">=</span> <span class="n">p_percentile_range</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span>
</span><span id="AutoTune.tune-128"><a href="#AutoTune.tune-128"><span class="linenos">128</span></a>      <span class="n">p_percentile_max</span> <span class="o">=</span> <span class="n">p_percentile_range</span><span class="p">[</span><span class="n">end_index</span><span class="p">]</span>
</span><span id="AutoTune.tune-129"><a href="#AutoTune.tune-129"><span class="linenos">129</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="AutoTune.tune-130"><a href="#AutoTune.tune-130"><span class="linenos">130</span></a>      <span class="n">p_percentile_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_percentile_range</span><span class="p">(</span><span class="n">p_percentile_min</span><span class="p">,</span>
</span><span id="AutoTune.tune-131"><a href="#AutoTune.tune-131"><span class="linenos">131</span></a>                                                        <span class="n">p_percentile_max</span><span class="p">,</span>
</span><span id="AutoTune.tune-132"><a href="#AutoTune.tune-132"><span class="linenos">132</span></a>                                                        <span class="bp">self</span><span class="o">.</span><span class="n">search_step</span><span class="p">)</span>
</span><span id="AutoTune.tune-133"><a href="#AutoTune.tune-133"><span class="linenos">133</span></a>    <span class="k">return</span> <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">best_p_percentile</span>
</span></pre></div>


            <div class="docstring"><p>Tune the hyper-parameter p_percentile.</p>

<p>Use a proxy ratio of DER to tune the hyper-parameter p_percentile. It also
performs some side work to do affinity refinement, eigen decomposition, and
estimate the number of clusters.</p>

<p>Args:
  p_percentile_to_ratio: a callable to compute the <code>ratio</code> given a
    <code>p_percentile</code> value</p>

<p>Returns:
  eigenvectors: sorted eigenvectors. numpy array of shape
  (n_samples, n_samples)
  n_clusters: number of clusters as an integer
  best_p_percentile: p_percentile value that minimizes the ratio</p>
</div>


                            </div>
                </section>
                <section id="ConstraintName">
                            <input id="ConstraintName-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ConstraintName</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="ConstraintName-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConstraintName"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConstraintName-12"><a href="#ConstraintName-12"><span class="linenos">12</span></a><span class="k">class</span> <span class="nc">ConstraintName</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="ConstraintName-13"><a href="#ConstraintName-13"><span class="linenos">13</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;The names of constrained operations.&quot;&quot;&quot;</span>
</span><span id="ConstraintName-14"><a href="#ConstraintName-14"><span class="linenos">14</span></a>  <span class="c1"># The Affinity Integration method</span>
</span><span id="ConstraintName-15"><a href="#ConstraintName-15"><span class="linenos">15</span></a>  <span class="n">AffinityIntegration</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="ConstraintName-16"><a href="#ConstraintName-16"><span class="linenos">16</span></a>
</span><span id="ConstraintName-17"><a href="#ConstraintName-17"><span class="linenos">17</span></a>  <span class="c1"># The Constraint Propagation method</span>
</span><span id="ConstraintName-18"><a href="#ConstraintName-18"><span class="linenos">18</span></a>  <span class="n">ConstraintPropagation</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The names of constrained operations.</p>
</div>


                            <div id="ConstraintName.AffinityIntegration" class="classattr">
                                <div class="attr variable">
            <span class="name">AffinityIntegration</span>        =
<span class="default_value">&lt;<a href="#ConstraintName.AffinityIntegration">ConstraintName.AffinityIntegration</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#ConstraintName.AffinityIntegration"></a>
    
    

                            </div>
                            <div id="ConstraintName.ConstraintPropagation" class="classattr">
                                <div class="attr variable">
            <span class="name">ConstraintPropagation</span>        =
<span class="default_value">&lt;<a href="#ConstraintName.ConstraintPropagation">ConstraintName.ConstraintPropagation</a>: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#ConstraintName.ConstraintPropagation"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="ConstraintName.name" class="variable">name</dd>
                <dd id="ConstraintName.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ConstraintOptions">
                            <input id="ConstraintOptions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">ConstraintOptions</span>:

                <label class="view-source-button" for="ConstraintOptions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConstraintOptions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConstraintOptions-27"><a href="#ConstraintOptions-27"><span class="linenos">27</span></a><span class="nd">@dataclass</span>
</span><span id="ConstraintOptions-28"><a href="#ConstraintOptions-28"><span class="linenos">28</span></a><span class="k">class</span> <span class="nc">ConstraintOptions</span><span class="p">:</span>
</span><span id="ConstraintOptions-29"><a href="#ConstraintOptions-29"><span class="linenos">29</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Constraint options for constrained clustering methods.&quot;&quot;&quot;</span>
</span><span id="ConstraintOptions-30"><a href="#ConstraintOptions-30"><span class="linenos">30</span></a>
</span><span id="ConstraintOptions-31"><a href="#ConstraintOptions-31"><span class="linenos">31</span></a>  <span class="c1"># Name of the constrained clustering method.</span>
</span><span id="ConstraintOptions-32"><a href="#ConstraintOptions-32"><span class="linenos">32</span></a>  <span class="n">constraint_name</span><span class="p">:</span> <span class="n">ConstraintName</span>
</span><span id="ConstraintOptions-33"><a href="#ConstraintOptions-33"><span class="linenos">33</span></a>
</span><span id="ConstraintOptions-34"><a href="#ConstraintOptions-34"><span class="linenos">34</span></a>  <span class="c1"># If True, this operation is applied before the affinity refinement.</span>
</span><span id="ConstraintOptions-35"><a href="#ConstraintOptions-35"><span class="linenos">35</span></a>  <span class="c1"># It is suggested to set as True for the ConstraintPropagation method</span>
</span><span id="ConstraintOptions-36"><a href="#ConstraintOptions-36"><span class="linenos">36</span></a>  <span class="c1"># and False for the AffinityIntegration method.</span>
</span><span id="ConstraintOptions-37"><a href="#ConstraintOptions-37"><span class="linenos">37</span></a>  <span class="n">apply_before_refinement</span><span class="p">:</span> <span class="nb">bool</span>
</span><span id="ConstraintOptions-38"><a href="#ConstraintOptions-38"><span class="linenos">38</span></a>
</span><span id="ConstraintOptions-39"><a href="#ConstraintOptions-39"><span class="linenos">39</span></a>  <span class="c1"># Integration type for the Affinity Integration method.</span>
</span><span id="ConstraintOptions-40"><a href="#ConstraintOptions-40"><span class="linenos">40</span></a>  <span class="n">integration_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">IntegrationType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ConstraintOptions-41"><a href="#ConstraintOptions-41"><span class="linenos">41</span></a>
</span><span id="ConstraintOptions-42"><a href="#ConstraintOptions-42"><span class="linenos">42</span></a>  <span class="c1"># alpha value of the constraint propagation method.</span>
</span><span id="ConstraintOptions-43"><a href="#ConstraintOptions-43"><span class="linenos">43</span></a>  <span class="n">constraint_propagation_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span>
</span><span id="ConstraintOptions-44"><a href="#ConstraintOptions-44"><span class="linenos">44</span></a>
</span><span id="ConstraintOptions-45"><a href="#ConstraintOptions-45"><span class="linenos">45</span></a>  <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ConstraintOptions-46"><a href="#ConstraintOptions-46"><span class="linenos">46</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_name</span> <span class="o">==</span> <span class="n">ConstraintName</span><span class="o">.</span><span class="n">AffinityIntegration</span><span class="p">:</span>
</span><span id="ConstraintOptions-47"><a href="#ConstraintOptions-47"><span class="linenos">47</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">constraint_operator</span> <span class="o">=</span> <span class="n">AffinityIntegration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">integration_type</span><span class="p">)</span>
</span><span id="ConstraintOptions-48"><a href="#ConstraintOptions-48"><span class="linenos">48</span></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_name</span> <span class="o">==</span> <span class="n">ConstraintName</span><span class="o">.</span><span class="n">ConstraintPropagation</span><span class="p">:</span>
</span><span id="ConstraintOptions-49"><a href="#ConstraintOptions-49"><span class="linenos">49</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">constraint_operator</span> <span class="o">=</span> <span class="n">ConstraintPropagation</span><span class="p">(</span>
</span><span id="ConstraintOptions-50"><a href="#ConstraintOptions-50"><span class="linenos">50</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">constraint_propagation_alpha</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Constraint options for constrained clustering methods.</p>
</div>


                            <div id="ConstraintOptions.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">ConstraintOptions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">constraint_name</span><span class="p">:</span> <span class="n"><a href="#ConstraintName">spectralcluster.configs.ConstraintName</a></span>,</span><span class="param">	<span class="n">apply_before_refinement</span><span class="p">:</span> <span class="nb">bool</span>,</span><span class="param">	<span class="n">integration_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="constraint.html#IntegrationType">spectralcluster.constraint.IntegrationType</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">constraint_propagation_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#ConstraintOptions.__init__"></a>
    
    

                            </div>
                            <div id="ConstraintOptions.constraint_name" class="classattr">
                                <div class="attr variable">
            <span class="name">constraint_name</span><span class="annotation">: <a href="#ConstraintName">spectralcluster.configs.ConstraintName</a></span>

        
    </div>
    <a class="headerlink" href="#ConstraintOptions.constraint_name"></a>
    
    

                            </div>
                            <div id="ConstraintOptions.apply_before_refinement" class="classattr">
                                <div class="attr variable">
            <span class="name">apply_before_refinement</span><span class="annotation">: bool</span>

        
    </div>
    <a class="headerlink" href="#ConstraintOptions.apply_before_refinement"></a>
    
    

                            </div>
                            <div id="ConstraintOptions.integration_type" class="classattr">
                                <div class="attr variable">
            <span class="name">integration_type</span><span class="annotation">: Optional[<a href="constraint.html#IntegrationType">spectralcluster.constraint.IntegrationType</a>]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#ConstraintOptions.integration_type"></a>
    
    

                            </div>
                            <div id="ConstraintOptions.constraint_propagation_alpha" class="classattr">
                                <div class="attr variable">
            <span class="name">constraint_propagation_alpha</span><span class="annotation">: float</span>        =
<span class="default_value">0.6</span>

        
    </div>
    <a class="headerlink" href="#ConstraintOptions.constraint_propagation_alpha"></a>
    
    

                            </div>
                </section>
                <section id="RefinementName">
                            <input id="RefinementName-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RefinementName</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="RefinementName-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RefinementName"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RefinementName-12"><a href="#RefinementName-12"><span class="linenos">12</span></a><span class="k">class</span> <span class="nc">RefinementName</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="RefinementName-13"><a href="#RefinementName-13"><span class="linenos">13</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;The names of the refinement operations.&quot;&quot;&quot;</span>
</span><span id="RefinementName-14"><a href="#RefinementName-14"><span class="linenos">14</span></a>  <span class="n">CropDiagonal</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="RefinementName-15"><a href="#RefinementName-15"><span class="linenos">15</span></a>  <span class="n">GaussianBlur</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="RefinementName-16"><a href="#RefinementName-16"><span class="linenos">16</span></a>  <span class="n">RowWiseThreshold</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="RefinementName-17"><a href="#RefinementName-17"><span class="linenos">17</span></a>  <span class="n">Symmetrize</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="RefinementName-18"><a href="#RefinementName-18"><span class="linenos">18</span></a>  <span class="n">Diffuse</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="RefinementName-19"><a href="#RefinementName-19"><span class="linenos">19</span></a>  <span class="n">RowWiseNormalize</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The names of the refinement operations.</p>
</div>


                            <div id="RefinementName.CropDiagonal" class="classattr">
                                <div class="attr variable">
            <span class="name">CropDiagonal</span>        =
<span class="default_value">&lt;<a href="#RefinementName.CropDiagonal">RefinementName.CropDiagonal</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementName.CropDiagonal"></a>
    
    

                            </div>
                            <div id="RefinementName.GaussianBlur" class="classattr">
                                <div class="attr variable">
            <span class="name">GaussianBlur</span>        =
<span class="default_value">&lt;<a href="#RefinementName.GaussianBlur">RefinementName.GaussianBlur</a>: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementName.GaussianBlur"></a>
    
    

                            </div>
                            <div id="RefinementName.RowWiseThreshold" class="classattr">
                                <div class="attr variable">
            <span class="name">RowWiseThreshold</span>        =
<span class="default_value">&lt;<a href="#RefinementName.RowWiseThreshold">RefinementName.RowWiseThreshold</a>: 3&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementName.RowWiseThreshold"></a>
    
    

                            </div>
                            <div id="RefinementName.Symmetrize" class="classattr">
                                <div class="attr variable">
            <span class="name">Symmetrize</span>        =
<span class="default_value">&lt;<a href="#RefinementName.Symmetrize">RefinementName.Symmetrize</a>: 4&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementName.Symmetrize"></a>
    
    

                            </div>
                            <div id="RefinementName.Diffuse" class="classattr">
                                <div class="attr variable">
            <span class="name">Diffuse</span>        =
<span class="default_value">&lt;<a href="#RefinementName.Diffuse">RefinementName.Diffuse</a>: 5&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementName.Diffuse"></a>
    
    

                            </div>
                            <div id="RefinementName.RowWiseNormalize" class="classattr">
                                <div class="attr variable">
            <span class="name">RowWiseNormalize</span>        =
<span class="default_value">&lt;<a href="#RefinementName.RowWiseNormalize">RefinementName.RowWiseNormalize</a>: 6&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementName.RowWiseNormalize"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="RefinementName.name" class="variable">name</dd>
                <dd id="RefinementName.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="RefinementOptions">
                            <input id="RefinementOptions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">RefinementOptions</span>:

                <label class="view-source-button" for="RefinementOptions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RefinementOptions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RefinementOptions-72"><a href="#RefinementOptions-72"><span class="linenos"> 72</span></a><span class="nd">@dataclass</span>
</span><span id="RefinementOptions-73"><a href="#RefinementOptions-73"><span class="linenos"> 73</span></a><span class="k">class</span> <span class="nc">RefinementOptions</span><span class="p">:</span>
</span><span id="RefinementOptions-74"><a href="#RefinementOptions-74"><span class="linenos"> 74</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Refinement options for the affinity matrix.&quot;&quot;&quot;</span>
</span><span id="RefinementOptions-75"><a href="#RefinementOptions-75"><span class="linenos"> 75</span></a>
</span><span id="RefinementOptions-76"><a href="#RefinementOptions-76"><span class="linenos"> 76</span></a>  <span class="c1"># Sigma value of the Gaussian blur operation.</span>
</span><span id="RefinementOptions-77"><a href="#RefinementOptions-77"><span class="linenos"> 77</span></a>  <span class="n">gaussian_blur_sigma</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="RefinementOptions-78"><a href="#RefinementOptions-78"><span class="linenos"> 78</span></a>
</span><span id="RefinementOptions-79"><a href="#RefinementOptions-79"><span class="linenos"> 79</span></a>  <span class="c1"># The p-percentile for the row wise thresholding.</span>
</span><span id="RefinementOptions-80"><a href="#RefinementOptions-80"><span class="linenos"> 80</span></a>  <span class="n">p_percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span>
</span><span id="RefinementOptions-81"><a href="#RefinementOptions-81"><span class="linenos"> 81</span></a>
</span><span id="RefinementOptions-82"><a href="#RefinementOptions-82"><span class="linenos"> 82</span></a>  <span class="c1"># The multiplier for soft threhsold, if this value is 0,</span>
</span><span id="RefinementOptions-83"><a href="#RefinementOptions-83"><span class="linenos"> 83</span></a>  <span class="c1"># then it&#39;s a hard thresholding.</span>
</span><span id="RefinementOptions-84"><a href="#RefinementOptions-84"><span class="linenos"> 84</span></a>  <span class="n">thresholding_soft_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>
</span><span id="RefinementOptions-85"><a href="#RefinementOptions-85"><span class="linenos"> 85</span></a>
</span><span id="RefinementOptions-86"><a href="#RefinementOptions-86"><span class="linenos"> 86</span></a>  <span class="c1"># The type of thresholding operation.</span>
</span><span id="RefinementOptions-87"><a href="#RefinementOptions-87"><span class="linenos"> 87</span></a>  <span class="n">thresholding_type</span><span class="p">:</span> <span class="n">ThresholdType</span> <span class="o">=</span> <span class="n">ThresholdType</span><span class="o">.</span><span class="n">RowMax</span>
</span><span id="RefinementOptions-88"><a href="#RefinementOptions-88"><span class="linenos"> 88</span></a>
</span><span id="RefinementOptions-89"><a href="#RefinementOptions-89"><span class="linenos"> 89</span></a>  <span class="c1"># If true, we set values larger than the threshold to 1.</span>
</span><span id="RefinementOptions-90"><a href="#RefinementOptions-90"><span class="linenos"> 90</span></a>  <span class="n">thresholding_with_binarization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="RefinementOptions-91"><a href="#RefinementOptions-91"><span class="linenos"> 91</span></a>
</span><span id="RefinementOptions-92"><a href="#RefinementOptions-92"><span class="linenos"> 92</span></a>  <span class="c1"># If true, in the row wise thresholding operation, we firstly set diagonals</span>
</span><span id="RefinementOptions-93"><a href="#RefinementOptions-93"><span class="linenos"> 93</span></a>  <span class="c1"># of the affinity matrix to 0, and set the diagonals back to 1 in the end.</span>
</span><span id="RefinementOptions-94"><a href="#RefinementOptions-94"><span class="linenos"> 94</span></a>  <span class="n">thresholding_preserve_diagonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="RefinementOptions-95"><a href="#RefinementOptions-95"><span class="linenos"> 95</span></a>
</span><span id="RefinementOptions-96"><a href="#RefinementOptions-96"><span class="linenos"> 96</span></a>  <span class="c1"># A SymmetrizeType.</span>
</span><span id="RefinementOptions-97"><a href="#RefinementOptions-97"><span class="linenos"> 97</span></a>  <span class="n">symmetrize_type</span><span class="p">:</span> <span class="n">SymmetrizeType</span> <span class="o">=</span> <span class="n">SymmetrizeType</span><span class="o">.</span><span class="n">Max</span>
</span><span id="RefinementOptions-98"><a href="#RefinementOptions-98"><span class="linenos"> 98</span></a>
</span><span id="RefinementOptions-99"><a href="#RefinementOptions-99"><span class="linenos"> 99</span></a>  <span class="c1"># A list of RefinementName for the sequence of refinement operations to</span>
</span><span id="RefinementOptions-100"><a href="#RefinementOptions-100"><span class="linenos">100</span></a>  <span class="c1"># apply on the affinity matrix.</span>
</span><span id="RefinementOptions-101"><a href="#RefinementOptions-101"><span class="linenos">101</span></a>  <span class="n">refinement_sequence</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">RefinementName</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="RefinementOptions-102"><a href="#RefinementOptions-102"><span class="linenos">102</span></a>
</span><span id="RefinementOptions-103"><a href="#RefinementOptions-103"><span class="linenos">103</span></a>  <span class="k">def</span> <span class="nf">get_refinement_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">RefinementName</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
</span><span id="RefinementOptions-104"><a href="#RefinementOptions-104"><span class="linenos">104</span></a>      <span class="n">AffinityRefinementOperation</span><span class="p">):</span>
</span><span id="RefinementOptions-105"><a href="#RefinementOptions-105"><span class="linenos">105</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the refinement operator for the affinity matrix.</span>
</span><span id="RefinementOptions-106"><a href="#RefinementOptions-106"><span class="linenos">106</span></a>
</span><span id="RefinementOptions-107"><a href="#RefinementOptions-107"><span class="linenos">107</span></a><span class="sd">    Args:</span>
</span><span id="RefinementOptions-108"><a href="#RefinementOptions-108"><span class="linenos">108</span></a><span class="sd">      name: a RefinementName</span>
</span><span id="RefinementOptions-109"><a href="#RefinementOptions-109"><span class="linenos">109</span></a>
</span><span id="RefinementOptions-110"><a href="#RefinementOptions-110"><span class="linenos">110</span></a><span class="sd">    Returns:</span>
</span><span id="RefinementOptions-111"><a href="#RefinementOptions-111"><span class="linenos">111</span></a><span class="sd">      object of the operator</span>
</span><span id="RefinementOptions-112"><a href="#RefinementOptions-112"><span class="linenos">112</span></a>
</span><span id="RefinementOptions-113"><a href="#RefinementOptions-113"><span class="linenos">113</span></a><span class="sd">    Raises:</span>
</span><span id="RefinementOptions-114"><a href="#RefinementOptions-114"><span class="linenos">114</span></a><span class="sd">      TypeError: if name is not a RefinementName</span>
</span><span id="RefinementOptions-115"><a href="#RefinementOptions-115"><span class="linenos">115</span></a><span class="sd">      ValueError: if name is an unknown refinement operation</span>
</span><span id="RefinementOptions-116"><a href="#RefinementOptions-116"><span class="linenos">116</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RefinementOptions-117"><a href="#RefinementOptions-117"><span class="linenos">117</span></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">CropDiagonal</span><span class="p">:</span>
</span><span id="RefinementOptions-118"><a href="#RefinementOptions-118"><span class="linenos">118</span></a>      <span class="k">return</span> <span class="n">CropDiagonal</span><span class="p">()</span>
</span><span id="RefinementOptions-119"><a href="#RefinementOptions-119"><span class="linenos">119</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">:</span>
</span><span id="RefinementOptions-120"><a href="#RefinementOptions-120"><span class="linenos">120</span></a>      <span class="k">return</span> <span class="n">GaussianBlur</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_blur_sigma</span><span class="p">)</span>
</span><span id="RefinementOptions-121"><a href="#RefinementOptions-121"><span class="linenos">121</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseThreshold</span><span class="p">:</span>
</span><span id="RefinementOptions-122"><a href="#RefinementOptions-122"><span class="linenos">122</span></a>      <span class="k">return</span> <span class="n">RowWiseThreshold</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_percentile</span><span class="p">,</span>
</span><span id="RefinementOptions-123"><a href="#RefinementOptions-123"><span class="linenos">123</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_soft_multiplier</span><span class="p">,</span>
</span><span id="RefinementOptions-124"><a href="#RefinementOptions-124"><span class="linenos">124</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_type</span><span class="p">,</span>
</span><span id="RefinementOptions-125"><a href="#RefinementOptions-125"><span class="linenos">125</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_with_binarization</span><span class="p">,</span>
</span><span id="RefinementOptions-126"><a href="#RefinementOptions-126"><span class="linenos">126</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_preserve_diagonal</span><span class="p">)</span>
</span><span id="RefinementOptions-127"><a href="#RefinementOptions-127"><span class="linenos">127</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">Symmetrize</span><span class="p">:</span>
</span><span id="RefinementOptions-128"><a href="#RefinementOptions-128"><span class="linenos">128</span></a>      <span class="k">return</span> <span class="n">Symmetrize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symmetrize_type</span><span class="p">)</span>
</span><span id="RefinementOptions-129"><a href="#RefinementOptions-129"><span class="linenos">129</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">Diffuse</span><span class="p">:</span>
</span><span id="RefinementOptions-130"><a href="#RefinementOptions-130"><span class="linenos">130</span></a>      <span class="k">return</span> <span class="n">Diffuse</span><span class="p">()</span>
</span><span id="RefinementOptions-131"><a href="#RefinementOptions-131"><span class="linenos">131</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseNormalize</span><span class="p">:</span>
</span><span id="RefinementOptions-132"><a href="#RefinementOptions-132"><span class="linenos">132</span></a>      <span class="k">return</span> <span class="n">RowWiseNormalize</span><span class="p">()</span>
</span><span id="RefinementOptions-133"><a href="#RefinementOptions-133"><span class="linenos">133</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="RefinementOptions-134"><a href="#RefinementOptions-134"><span class="linenos">134</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown refinement operation: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Refinement options for the affinity matrix.</p>
</div>


                            <div id="RefinementOptions.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">RefinementOptions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">gaussian_blur_sigma</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">p_percentile</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span>,</span><span class="param">	<span class="n">thresholding_soft_multiplier</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>,</span><span class="param">	<span class="n">thresholding_type</span><span class="p">:</span> <span class="n"><a href="#ThresholdType">spectralcluster.configs.ThresholdType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#ThresholdType.RowMax">ThresholdType.RowMax</a></span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">thresholding_with_binarization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">thresholding_preserve_diagonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">symmetrize_type</span><span class="p">:</span> <span class="n"><a href="#SymmetrizeType">spectralcluster.configs.SymmetrizeType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n"><a href="#SymmetrizeType.Max">SymmetrizeType.Max</a></span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">refinement_sequence</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n"><a href="#RefinementName">spectralcluster.configs.RefinementName</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.__init__"></a>
    
    

                            </div>
                            <div id="RefinementOptions.gaussian_blur_sigma" class="classattr">
                                <div class="attr variable">
            <span class="name">gaussian_blur_sigma</span><span class="annotation">: int</span>        =
<span class="default_value">1</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.gaussian_blur_sigma"></a>
    
    

                            </div>
                            <div id="RefinementOptions.p_percentile" class="classattr">
                                <div class="attr variable">
            <span class="name">p_percentile</span><span class="annotation">: float</span>        =
<span class="default_value">0.95</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.p_percentile"></a>
    
    

                            </div>
                            <div id="RefinementOptions.thresholding_soft_multiplier" class="classattr">
                                <div class="attr variable">
            <span class="name">thresholding_soft_multiplier</span><span class="annotation">: float</span>        =
<span class="default_value">0.01</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.thresholding_soft_multiplier"></a>
    
    

                            </div>
                            <div id="RefinementOptions.thresholding_type" class="classattr">
                                <div class="attr variable">
            <span class="name">thresholding_type</span><span class="annotation">: <a href="#ThresholdType">spectralcluster.configs.ThresholdType</a></span>        =
<span class="default_value">&lt;<a href="#ThresholdType.RowMax">ThresholdType.RowMax</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.thresholding_type"></a>
    
    

                            </div>
                            <div id="RefinementOptions.thresholding_with_binarization" class="classattr">
                                <div class="attr variable">
            <span class="name">thresholding_with_binarization</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.thresholding_with_binarization"></a>
    
    

                            </div>
                            <div id="RefinementOptions.thresholding_preserve_diagonal" class="classattr">
                                <div class="attr variable">
            <span class="name">thresholding_preserve_diagonal</span><span class="annotation">: bool</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.thresholding_preserve_diagonal"></a>
    
    

                            </div>
                            <div id="RefinementOptions.symmetrize_type" class="classattr">
                                <div class="attr variable">
            <span class="name">symmetrize_type</span><span class="annotation">: <a href="#SymmetrizeType">spectralcluster.configs.SymmetrizeType</a></span>        =
<span class="default_value">&lt;<a href="#SymmetrizeType.Max">SymmetrizeType.Max</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.symmetrize_type"></a>
    
    

                            </div>
                            <div id="RefinementOptions.refinement_sequence" class="classattr">
                                <div class="attr variable">
            <span class="name">refinement_sequence</span><span class="annotation">: Optional[Sequence[<a href="#RefinementName">spectralcluster.configs.RefinementName</a>]]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#RefinementOptions.refinement_sequence"></a>
    
    

                            </div>
                            <div id="RefinementOptions.get_refinement_operator" class="classattr">
                                        <input id="RefinementOptions.get_refinement_operator-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_refinement_operator</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">name</span><span class="p">:</span> <span class="n"><a href="#RefinementName">spectralcluster.configs.RefinementName</a></span></span><span class="return-annotation">) -> <span class="n"><a href="refinement.html#AffinityRefinementOperation">spectralcluster.refinement.AffinityRefinementOperation</a></span>:</span></span>

                <label class="view-source-button" for="RefinementOptions.get_refinement_operator-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RefinementOptions.get_refinement_operator"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RefinementOptions.get_refinement_operator-103"><a href="#RefinementOptions.get_refinement_operator-103"><span class="linenos">103</span></a>  <span class="k">def</span> <span class="nf">get_refinement_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">RefinementName</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
</span><span id="RefinementOptions.get_refinement_operator-104"><a href="#RefinementOptions.get_refinement_operator-104"><span class="linenos">104</span></a>      <span class="n">AffinityRefinementOperation</span><span class="p">):</span>
</span><span id="RefinementOptions.get_refinement_operator-105"><a href="#RefinementOptions.get_refinement_operator-105"><span class="linenos">105</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the refinement operator for the affinity matrix.</span>
</span><span id="RefinementOptions.get_refinement_operator-106"><a href="#RefinementOptions.get_refinement_operator-106"><span class="linenos">106</span></a>
</span><span id="RefinementOptions.get_refinement_operator-107"><a href="#RefinementOptions.get_refinement_operator-107"><span class="linenos">107</span></a><span class="sd">    Args:</span>
</span><span id="RefinementOptions.get_refinement_operator-108"><a href="#RefinementOptions.get_refinement_operator-108"><span class="linenos">108</span></a><span class="sd">      name: a RefinementName</span>
</span><span id="RefinementOptions.get_refinement_operator-109"><a href="#RefinementOptions.get_refinement_operator-109"><span class="linenos">109</span></a>
</span><span id="RefinementOptions.get_refinement_operator-110"><a href="#RefinementOptions.get_refinement_operator-110"><span class="linenos">110</span></a><span class="sd">    Returns:</span>
</span><span id="RefinementOptions.get_refinement_operator-111"><a href="#RefinementOptions.get_refinement_operator-111"><span class="linenos">111</span></a><span class="sd">      object of the operator</span>
</span><span id="RefinementOptions.get_refinement_operator-112"><a href="#RefinementOptions.get_refinement_operator-112"><span class="linenos">112</span></a>
</span><span id="RefinementOptions.get_refinement_operator-113"><a href="#RefinementOptions.get_refinement_operator-113"><span class="linenos">113</span></a><span class="sd">    Raises:</span>
</span><span id="RefinementOptions.get_refinement_operator-114"><a href="#RefinementOptions.get_refinement_operator-114"><span class="linenos">114</span></a><span class="sd">      TypeError: if name is not a RefinementName</span>
</span><span id="RefinementOptions.get_refinement_operator-115"><a href="#RefinementOptions.get_refinement_operator-115"><span class="linenos">115</span></a><span class="sd">      ValueError: if name is an unknown refinement operation</span>
</span><span id="RefinementOptions.get_refinement_operator-116"><a href="#RefinementOptions.get_refinement_operator-116"><span class="linenos">116</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RefinementOptions.get_refinement_operator-117"><a href="#RefinementOptions.get_refinement_operator-117"><span class="linenos">117</span></a>    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">CropDiagonal</span><span class="p">:</span>
</span><span id="RefinementOptions.get_refinement_operator-118"><a href="#RefinementOptions.get_refinement_operator-118"><span class="linenos">118</span></a>      <span class="k">return</span> <span class="n">CropDiagonal</span><span class="p">()</span>
</span><span id="RefinementOptions.get_refinement_operator-119"><a href="#RefinementOptions.get_refinement_operator-119"><span class="linenos">119</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">:</span>
</span><span id="RefinementOptions.get_refinement_operator-120"><a href="#RefinementOptions.get_refinement_operator-120"><span class="linenos">120</span></a>      <span class="k">return</span> <span class="n">GaussianBlur</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_blur_sigma</span><span class="p">)</span>
</span><span id="RefinementOptions.get_refinement_operator-121"><a href="#RefinementOptions.get_refinement_operator-121"><span class="linenos">121</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseThreshold</span><span class="p">:</span>
</span><span id="RefinementOptions.get_refinement_operator-122"><a href="#RefinementOptions.get_refinement_operator-122"><span class="linenos">122</span></a>      <span class="k">return</span> <span class="n">RowWiseThreshold</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_percentile</span><span class="p">,</span>
</span><span id="RefinementOptions.get_refinement_operator-123"><a href="#RefinementOptions.get_refinement_operator-123"><span class="linenos">123</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_soft_multiplier</span><span class="p">,</span>
</span><span id="RefinementOptions.get_refinement_operator-124"><a href="#RefinementOptions.get_refinement_operator-124"><span class="linenos">124</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_type</span><span class="p">,</span>
</span><span id="RefinementOptions.get_refinement_operator-125"><a href="#RefinementOptions.get_refinement_operator-125"><span class="linenos">125</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_with_binarization</span><span class="p">,</span>
</span><span id="RefinementOptions.get_refinement_operator-126"><a href="#RefinementOptions.get_refinement_operator-126"><span class="linenos">126</span></a>                              <span class="bp">self</span><span class="o">.</span><span class="n">thresholding_preserve_diagonal</span><span class="p">)</span>
</span><span id="RefinementOptions.get_refinement_operator-127"><a href="#RefinementOptions.get_refinement_operator-127"><span class="linenos">127</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">Symmetrize</span><span class="p">:</span>
</span><span id="RefinementOptions.get_refinement_operator-128"><a href="#RefinementOptions.get_refinement_operator-128"><span class="linenos">128</span></a>      <span class="k">return</span> <span class="n">Symmetrize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symmetrize_type</span><span class="p">)</span>
</span><span id="RefinementOptions.get_refinement_operator-129"><a href="#RefinementOptions.get_refinement_operator-129"><span class="linenos">129</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">Diffuse</span><span class="p">:</span>
</span><span id="RefinementOptions.get_refinement_operator-130"><a href="#RefinementOptions.get_refinement_operator-130"><span class="linenos">130</span></a>      <span class="k">return</span> <span class="n">Diffuse</span><span class="p">()</span>
</span><span id="RefinementOptions.get_refinement_operator-131"><a href="#RefinementOptions.get_refinement_operator-131"><span class="linenos">131</span></a>    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseNormalize</span><span class="p">:</span>
</span><span id="RefinementOptions.get_refinement_operator-132"><a href="#RefinementOptions.get_refinement_operator-132"><span class="linenos">132</span></a>      <span class="k">return</span> <span class="n">RowWiseNormalize</span><span class="p">()</span>
</span><span id="RefinementOptions.get_refinement_operator-133"><a href="#RefinementOptions.get_refinement_operator-133"><span class="linenos">133</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="RefinementOptions.get_refinement_operator-134"><a href="#RefinementOptions.get_refinement_operator-134"><span class="linenos">134</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown refinement operation: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get the refinement operator for the affinity matrix.</p>

<p>Args:
  name: a RefinementName</p>

<p>Returns:
  object of the operator</p>

<p>Raises:
  TypeError: if name is not a RefinementName
  ValueError: if name is an unknown refinement operation</p>
</div>


                            </div>
                </section>
                <section id="ThresholdType">
                            <input id="ThresholdType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ThresholdType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="ThresholdType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThresholdType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThresholdType-22"><a href="#ThresholdType-22"><span class="linenos">22</span></a><span class="k">class</span> <span class="nc">ThresholdType</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="ThresholdType-23"><a href="#ThresholdType-23"><span class="linenos">23</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Different types of thresholding.&quot;&quot;&quot;</span>
</span><span id="ThresholdType-24"><a href="#ThresholdType-24"><span class="linenos">24</span></a>  <span class="c1"># We clear values that are smaller than row_max*p_percentile</span>
</span><span id="ThresholdType-25"><a href="#ThresholdType-25"><span class="linenos">25</span></a>  <span class="n">RowMax</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="ThresholdType-26"><a href="#ThresholdType-26"><span class="linenos">26</span></a>
</span><span id="ThresholdType-27"><a href="#ThresholdType-27"><span class="linenos">27</span></a>  <span class="c1"># We clear (p_percentile*100)% smallest values of the entire row</span>
</span><span id="ThresholdType-28"><a href="#ThresholdType-28"><span class="linenos">28</span></a>  <span class="n">Percentile</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Different types of thresholding.</p>
</div>


                            <div id="ThresholdType.RowMax" class="classattr">
                                <div class="attr variable">
            <span class="name">RowMax</span>        =
<span class="default_value">&lt;<a href="#ThresholdType.RowMax">ThresholdType.RowMax</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#ThresholdType.RowMax"></a>
    
    

                            </div>
                            <div id="ThresholdType.Percentile" class="classattr">
                                <div class="attr variable">
            <span class="name">Percentile</span>        =
<span class="default_value">&lt;<a href="#ThresholdType.Percentile">ThresholdType.Percentile</a>: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#ThresholdType.Percentile"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="ThresholdType.name" class="variable">name</dd>
                <dd id="ThresholdType.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SymmetrizeType">
                            <input id="SymmetrizeType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SymmetrizeType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="SymmetrizeType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SymmetrizeType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SymmetrizeType-31"><a href="#SymmetrizeType-31"><span class="linenos">31</span></a><span class="k">class</span> <span class="nc">SymmetrizeType</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="SymmetrizeType-32"><a href="#SymmetrizeType-32"><span class="linenos">32</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Different types of symmetrization operation.&quot;&quot;&quot;</span>
</span><span id="SymmetrizeType-33"><a href="#SymmetrizeType-33"><span class="linenos">33</span></a>  <span class="c1"># We use max(A, A^T)</span>
</span><span id="SymmetrizeType-34"><a href="#SymmetrizeType-34"><span class="linenos">34</span></a>  <span class="n">Max</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="SymmetrizeType-35"><a href="#SymmetrizeType-35"><span class="linenos">35</span></a>
</span><span id="SymmetrizeType-36"><a href="#SymmetrizeType-36"><span class="linenos">36</span></a>  <span class="c1"># We use 1/2(A + A^T)</span>
</span><span id="SymmetrizeType-37"><a href="#SymmetrizeType-37"><span class="linenos">37</span></a>  <span class="n">Average</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Different types of symmetrization operation.</p>
</div>


                            <div id="SymmetrizeType.Max" class="classattr">
                                <div class="attr variable">
            <span class="name">Max</span>        =
<span class="default_value">&lt;<a href="#SymmetrizeType.Max">SymmetrizeType.Max</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#SymmetrizeType.Max"></a>
    
    

                            </div>
                            <div id="SymmetrizeType.Average" class="classattr">
                                <div class="attr variable">
            <span class="name">Average</span>        =
<span class="default_value">&lt;<a href="#SymmetrizeType.Average">SymmetrizeType.Average</a>: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#SymmetrizeType.Average"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="SymmetrizeType.name" class="variable">name</dd>
                <dd id="SymmetrizeType.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="LaplacianType">
                            <input id="LaplacianType-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LaplacianType</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="LaplacianType-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LaplacianType"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LaplacianType-10"><a href="#LaplacianType-10"><span class="linenos">10</span></a><span class="k">class</span> <span class="nc">LaplacianType</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="LaplacianType-11"><a href="#LaplacianType-11"><span class="linenos">11</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Different types of Laplacian matrix.&quot;&quot;&quot;</span>
</span><span id="LaplacianType-12"><a href="#LaplacianType-12"><span class="linenos">12</span></a>  <span class="c1"># The affinity matrix, not a Laplacian: W</span>
</span><span id="LaplacianType-13"><a href="#LaplacianType-13"><span class="linenos">13</span></a>  <span class="n">Affinity</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="LaplacianType-14"><a href="#LaplacianType-14"><span class="linenos">14</span></a>
</span><span id="LaplacianType-15"><a href="#LaplacianType-15"><span class="linenos">15</span></a>  <span class="c1"># The unnormalied Laplacian: L = D - W</span>
</span><span id="LaplacianType-16"><a href="#LaplacianType-16"><span class="linenos">16</span></a>  <span class="n">Unnormalized</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="LaplacianType-17"><a href="#LaplacianType-17"><span class="linenos">17</span></a>
</span><span id="LaplacianType-18"><a href="#LaplacianType-18"><span class="linenos">18</span></a>  <span class="c1"># The random walk view normalized Laplacian:  D^{-1} * L</span>
</span><span id="LaplacianType-19"><a href="#LaplacianType-19"><span class="linenos">19</span></a>  <span class="n">RandomWalk</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span><span id="LaplacianType-20"><a href="#LaplacianType-20"><span class="linenos">20</span></a>
</span><span id="LaplacianType-21"><a href="#LaplacianType-21"><span class="linenos">21</span></a>  <span class="c1"># The graph cut view normalized Laplacian: D^{-1/2} * L * D^{-1/2}</span>
</span><span id="LaplacianType-22"><a href="#LaplacianType-22"><span class="linenos">22</span></a>  <span class="n">GraphCut</span> <span class="o">=</span> <span class="n">enum</span><span class="o">.</span><span class="n">auto</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Different types of Laplacian matrix.</p>
</div>


                            <div id="LaplacianType.Affinity" class="classattr">
                                <div class="attr variable">
            <span class="name">Affinity</span>        =
<span class="default_value">&lt;<a href="#LaplacianType.Affinity">LaplacianType.Affinity</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#LaplacianType.Affinity"></a>
    
    

                            </div>
                            <div id="LaplacianType.Unnormalized" class="classattr">
                                <div class="attr variable">
            <span class="name">Unnormalized</span>        =
<span class="default_value">&lt;<a href="#LaplacianType.Unnormalized">LaplacianType.Unnormalized</a>: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#LaplacianType.Unnormalized"></a>
    
    

                            </div>
                            <div id="LaplacianType.RandomWalk" class="classattr">
                                <div class="attr variable">
            <span class="name">RandomWalk</span>        =
<span class="default_value">&lt;<a href="#LaplacianType.RandomWalk">LaplacianType.RandomWalk</a>: 3&gt;</span>

        
    </div>
    <a class="headerlink" href="#LaplacianType.RandomWalk"></a>
    
    

                            </div>
                            <div id="LaplacianType.GraphCut" class="classattr">
                                <div class="attr variable">
            <span class="name">GraphCut</span>        =
<span class="default_value">&lt;<a href="#LaplacianType.GraphCut">LaplacianType.GraphCut</a>: 4&gt;</span>

        
    </div>
    <a class="headerlink" href="#LaplacianType.GraphCut"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="LaplacianType.name" class="variable">name</dd>
                <dd id="LaplacianType.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SpectralClusterer">
                            <input id="SpectralClusterer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SpectralClusterer</span>:

                <label class="view-source-button" for="SpectralClusterer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpectralClusterer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpectralClusterer-27"><a href="#SpectralClusterer-27"><span class="linenos"> 27</span></a><span class="k">class</span> <span class="nc">SpectralClusterer</span><span class="p">:</span>
</span><span id="SpectralClusterer-28"><a href="#SpectralClusterer-28"><span class="linenos"> 28</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Spectral clustering class.&quot;&quot;&quot;</span>
</span><span id="SpectralClusterer-29"><a href="#SpectralClusterer-29"><span class="linenos"> 29</span></a>
</span><span id="SpectralClusterer-30"><a href="#SpectralClusterer-30"><span class="linenos"> 30</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpectralClusterer-31"><a href="#SpectralClusterer-31"><span class="linenos"> 31</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="SpectralClusterer-32"><a href="#SpectralClusterer-32"><span class="linenos"> 32</span></a>      <span class="n">min_clusters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-33"><a href="#SpectralClusterer-33"><span class="linenos"> 33</span></a>      <span class="n">max_clusters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-34"><a href="#SpectralClusterer-34"><span class="linenos"> 34</span></a>      <span class="n">refinement_options</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">RefinementOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-35"><a href="#SpectralClusterer-35"><span class="linenos"> 35</span></a>      <span class="n">autotune</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AutoTune</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-36"><a href="#SpectralClusterer-36"><span class="linenos"> 36</span></a>      <span class="n">fallback_options</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">FallbackOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-37"><a href="#SpectralClusterer-37"><span class="linenos"> 37</span></a>      <span class="n">laplacian_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">LaplacianType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-38"><a href="#SpectralClusterer-38"><span class="linenos"> 38</span></a>      <span class="n">stop_eigenvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
</span><span id="SpectralClusterer-39"><a href="#SpectralClusterer-39"><span class="linenos"> 39</span></a>      <span class="n">row_wise_renorm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="SpectralClusterer-40"><a href="#SpectralClusterer-40"><span class="linenos"> 40</span></a>      <span class="n">custom_dist</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cosine&quot;</span><span class="p">,</span>
</span><span id="SpectralClusterer-41"><a href="#SpectralClusterer-41"><span class="linenos"> 41</span></a>      <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
</span><span id="SpectralClusterer-42"><a href="#SpectralClusterer-42"><span class="linenos"> 42</span></a>      <span class="n">constraint_options</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">ConstraintOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-43"><a href="#SpectralClusterer-43"><span class="linenos"> 43</span></a>      <span class="n">eigengap_type</span><span class="p">:</span> <span class="n">EigenGapType</span> <span class="o">=</span> <span class="n">EigenGapType</span><span class="o">.</span><span class="n">Ratio</span><span class="p">,</span>
</span><span id="SpectralClusterer-44"><a href="#SpectralClusterer-44"><span class="linenos"> 44</span></a>      <span class="n">max_spectral_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer-45"><a href="#SpectralClusterer-45"><span class="linenos"> 45</span></a>      <span class="n">affinity_function</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compute_affinity_matrix</span><span class="p">,</span>
</span><span id="SpectralClusterer-46"><a href="#SpectralClusterer-46"><span class="linenos"> 46</span></a>      <span class="n">post_eigen_cluster_function</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpectralClusterer-47"><a href="#SpectralClusterer-47"><span class="linenos"> 47</span></a>          <span class="n">custom_distance_kmeans</span><span class="o">.</span><span class="n">run_kmeans</span><span class="p">)):</span>
</span><span id="SpectralClusterer-48"><a href="#SpectralClusterer-48"><span class="linenos"> 48</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor of the clusterer.</span>
</span><span id="SpectralClusterer-49"><a href="#SpectralClusterer-49"><span class="linenos"> 49</span></a>
</span><span id="SpectralClusterer-50"><a href="#SpectralClusterer-50"><span class="linenos"> 50</span></a><span class="sd">    Args:</span>
</span><span id="SpectralClusterer-51"><a href="#SpectralClusterer-51"><span class="linenos"> 51</span></a><span class="sd">      min_clusters: minimal number of clusters allowed (only effective if not</span>
</span><span id="SpectralClusterer-52"><a href="#SpectralClusterer-52"><span class="linenos"> 52</span></a><span class="sd">        None)</span>
</span><span id="SpectralClusterer-53"><a href="#SpectralClusterer-53"><span class="linenos"> 53</span></a><span class="sd">      max_clusters: maximal number of clusters allowed (only effective if not</span>
</span><span id="SpectralClusterer-54"><a href="#SpectralClusterer-54"><span class="linenos"> 54</span></a><span class="sd">        None), can be used together with min_clusters to fix the number of</span>
</span><span id="SpectralClusterer-55"><a href="#SpectralClusterer-55"><span class="linenos"> 55</span></a><span class="sd">        clusters</span>
</span><span id="SpectralClusterer-56"><a href="#SpectralClusterer-56"><span class="linenos"> 56</span></a><span class="sd">      refinement_options: a RefinementOptions object that contains refinement</span>
</span><span id="SpectralClusterer-57"><a href="#SpectralClusterer-57"><span class="linenos"> 57</span></a><span class="sd">        arguments for the affinity matrix. If None, we will not refine</span>
</span><span id="SpectralClusterer-58"><a href="#SpectralClusterer-58"><span class="linenos"> 58</span></a><span class="sd">      autotune: an AutoTune object to automatically search p_percentile</span>
</span><span id="SpectralClusterer-59"><a href="#SpectralClusterer-59"><span class="linenos"> 59</span></a><span class="sd">      fallback_options: a FallbackOptions object to indicate when to run</span>
</span><span id="SpectralClusterer-60"><a href="#SpectralClusterer-60"><span class="linenos"> 60</span></a><span class="sd">        fallback clusterer instead of spectral clusterer</span>
</span><span id="SpectralClusterer-61"><a href="#SpectralClusterer-61"><span class="linenos"> 61</span></a><span class="sd">      laplacian_type: a LaplacianType. If None, we do not use a laplacian matrix</span>
</span><span id="SpectralClusterer-62"><a href="#SpectralClusterer-62"><span class="linenos"> 62</span></a><span class="sd">      stop_eigenvalue: when computing the number of clusters using Eigen Gap, we</span>
</span><span id="SpectralClusterer-63"><a href="#SpectralClusterer-63"><span class="linenos"> 63</span></a><span class="sd">        do not look at eigen values smaller than this value</span>
</span><span id="SpectralClusterer-64"><a href="#SpectralClusterer-64"><span class="linenos"> 64</span></a><span class="sd">      row_wise_renorm: if True, perform row-wise re-normalization on the</span>
</span><span id="SpectralClusterer-65"><a href="#SpectralClusterer-65"><span class="linenos"> 65</span></a><span class="sd">        spectral embeddings</span>
</span><span id="SpectralClusterer-66"><a href="#SpectralClusterer-66"><span class="linenos"> 66</span></a><span class="sd">      custom_dist: str or callable. custom distance measure for k-means. If a</span>
</span><span id="SpectralClusterer-67"><a href="#SpectralClusterer-67"><span class="linenos"> 67</span></a><span class="sd">        string, &quot;cosine&quot;, &quot;euclidean&quot;, &quot;mahalanobis&quot;, or any other distance</span>
</span><span id="SpectralClusterer-68"><a href="#SpectralClusterer-68"><span class="linenos"> 68</span></a><span class="sd">        functions defined in scipy.spatial.distance can be used</span>
</span><span id="SpectralClusterer-69"><a href="#SpectralClusterer-69"><span class="linenos"> 69</span></a><span class="sd">      max_iter: the maximum number of iterations for the custom k-means</span>
</span><span id="SpectralClusterer-70"><a href="#SpectralClusterer-70"><span class="linenos"> 70</span></a><span class="sd">      constraint_options: a ConstraintOptions object that contains constraint</span>
</span><span id="SpectralClusterer-71"><a href="#SpectralClusterer-71"><span class="linenos"> 71</span></a><span class="sd">        arguments</span>
</span><span id="SpectralClusterer-72"><a href="#SpectralClusterer-72"><span class="linenos"> 72</span></a><span class="sd">      eigengap_type: the type of the eigengap computation</span>
</span><span id="SpectralClusterer-73"><a href="#SpectralClusterer-73"><span class="linenos"> 73</span></a><span class="sd">      max_spectral_size: the maximal size of input to the spectral clustering</span>
</span><span id="SpectralClusterer-74"><a href="#SpectralClusterer-74"><span class="linenos"> 74</span></a><span class="sd">        algorithm. If this is set, and the actual input size is larger than</span>
</span><span id="SpectralClusterer-75"><a href="#SpectralClusterer-75"><span class="linenos"> 75</span></a><span class="sd">        this value, then we are going to first use hierarchical clustering</span>
</span><span id="SpectralClusterer-76"><a href="#SpectralClusterer-76"><span class="linenos"> 76</span></a><span class="sd">        to reduce the input size to this number. This can significantly reduce</span>
</span><span id="SpectralClusterer-77"><a href="#SpectralClusterer-77"><span class="linenos"> 77</span></a><span class="sd">        the computational cost for steps like Laplacian matrix and eigen</span>
</span><span id="SpectralClusterer-78"><a href="#SpectralClusterer-78"><span class="linenos"> 78</span></a><span class="sd">        decomposition. However, please note that this may degrade the quality</span>
</span><span id="SpectralClusterer-79"><a href="#SpectralClusterer-79"><span class="linenos"> 79</span></a><span class="sd">        of the final clustering results. This corresponds to the U1 value in</span>
</span><span id="SpectralClusterer-80"><a href="#SpectralClusterer-80"><span class="linenos"> 80</span></a><span class="sd">        the multi-stage clustering paper (https://arxiv.org/abs/2210.13690)</span>
</span><span id="SpectralClusterer-81"><a href="#SpectralClusterer-81"><span class="linenos"> 81</span></a><span class="sd">      affinity_function: a function to compute the affinity matrix from the</span>
</span><span id="SpectralClusterer-82"><a href="#SpectralClusterer-82"><span class="linenos"> 82</span></a><span class="sd">        embeddings. This defaults to (cos(x,y)+1)/2</span>
</span><span id="SpectralClusterer-83"><a href="#SpectralClusterer-83"><span class="linenos"> 83</span></a><span class="sd">      post_eigen_cluster_function: a function to cluster the spectral embeddings</span>
</span><span id="SpectralClusterer-84"><a href="#SpectralClusterer-84"><span class="linenos"> 84</span></a><span class="sd">        after the eigenvalue computations. This function must have the same</span>
</span><span id="SpectralClusterer-85"><a href="#SpectralClusterer-85"><span class="linenos"> 85</span></a><span class="sd">        signature as custom_distance_kmeans.run_kmeans</span>
</span><span id="SpectralClusterer-86"><a href="#SpectralClusterer-86"><span class="linenos"> 86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpectralClusterer-87"><a href="#SpectralClusterer-87"><span class="linenos"> 87</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="o">=</span> <span class="n">min_clusters</span>
</span><span id="SpectralClusterer-88"><a href="#SpectralClusterer-88"><span class="linenos"> 88</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span> <span class="o">=</span> <span class="n">max_clusters</span>
</span><span id="SpectralClusterer-89"><a href="#SpectralClusterer-89"><span class="linenos"> 89</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">refinement_options</span><span class="p">:</span>
</span><span id="SpectralClusterer-90"><a href="#SpectralClusterer-90"><span class="linenos"> 90</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span> <span class="o">=</span> <span class="n">refinement</span><span class="o">.</span><span class="n">RefinementOptions</span><span class="p">()</span>
</span><span id="SpectralClusterer-91"><a href="#SpectralClusterer-91"><span class="linenos"> 91</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer-92"><a href="#SpectralClusterer-92"><span class="linenos"> 92</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span> <span class="o">=</span> <span class="n">refinement_options</span>
</span><span id="SpectralClusterer-93"><a href="#SpectralClusterer-93"><span class="linenos"> 93</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span> <span class="o">=</span> <span class="n">autotune</span>
</span><span id="SpectralClusterer-94"><a href="#SpectralClusterer-94"><span class="linenos"> 94</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">fallback_options</span><span class="p">:</span>
</span><span id="SpectralClusterer-95"><a href="#SpectralClusterer-95"><span class="linenos"> 95</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span> <span class="o">=</span> <span class="n">fallback_clusterer</span><span class="o">.</span><span class="n">FallbackOptions</span><span class="p">()</span>
</span><span id="SpectralClusterer-96"><a href="#SpectralClusterer-96"><span class="linenos"> 96</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer-97"><a href="#SpectralClusterer-97"><span class="linenos"> 97</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span> <span class="o">=</span> <span class="n">fallback_options</span>
</span><span id="SpectralClusterer-98"><a href="#SpectralClusterer-98"><span class="linenos"> 98</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">laplacian_type</span> <span class="o">=</span> <span class="n">laplacian_type</span>
</span><span id="SpectralClusterer-99"><a href="#SpectralClusterer-99"><span class="linenos"> 99</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">row_wise_renorm</span> <span class="o">=</span> <span class="n">row_wise_renorm</span>
</span><span id="SpectralClusterer-100"><a href="#SpectralClusterer-100"><span class="linenos">100</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stop_eigenvalue</span> <span class="o">=</span> <span class="n">stop_eigenvalue</span>
</span><span id="SpectralClusterer-101"><a href="#SpectralClusterer-101"><span class="linenos">101</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">custom_dist</span> <span class="o">=</span> <span class="n">custom_dist</span>
</span><span id="SpectralClusterer-102"><a href="#SpectralClusterer-102"><span class="linenos">102</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="n">max_iter</span>
</span><span id="SpectralClusterer-103"><a href="#SpectralClusterer-103"><span class="linenos">103</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span> <span class="o">=</span> <span class="n">constraint_options</span>
</span><span id="SpectralClusterer-104"><a href="#SpectralClusterer-104"><span class="linenos">104</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">eigengap_type</span> <span class="o">=</span> <span class="n">eigengap_type</span>
</span><span id="SpectralClusterer-105"><a href="#SpectralClusterer-105"><span class="linenos">105</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">=</span> <span class="n">max_spectral_size</span>
</span><span id="SpectralClusterer-106"><a href="#SpectralClusterer-106"><span class="linenos">106</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">affinity_function</span> <span class="o">=</span> <span class="n">affinity_function</span>
</span><span id="SpectralClusterer-107"><a href="#SpectralClusterer-107"><span class="linenos">107</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">post_eigen_cluster_function</span> <span class="o">=</span> <span class="n">post_eigen_cluster_function</span>
</span><span id="SpectralClusterer-108"><a href="#SpectralClusterer-108"><span class="linenos">108</span></a>
</span><span id="SpectralClusterer-109"><a href="#SpectralClusterer-109"><span class="linenos">109</span></a>  <span class="k">def</span> <span class="nf">_compute_eigenvectors_ncluster</span><span class="p">(</span>
</span><span id="SpectralClusterer-110"><a href="#SpectralClusterer-110"><span class="linenos">110</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="SpectralClusterer-111"><a href="#SpectralClusterer-111"><span class="linenos">111</span></a>      <span class="n">affinity</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="SpectralClusterer-112"><a href="#SpectralClusterer-112"><span class="linenos">112</span></a>      <span class="n">constraint_matrix</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
</span><span id="SpectralClusterer-113"><a href="#SpectralClusterer-113"><span class="linenos">113</span></a>          <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]):</span>
</span><span id="SpectralClusterer-114"><a href="#SpectralClusterer-114"><span class="linenos">114</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform eigen decomposition and estiamte the number of clusters.</span>
</span><span id="SpectralClusterer-115"><a href="#SpectralClusterer-115"><span class="linenos">115</span></a>
</span><span id="SpectralClusterer-116"><a href="#SpectralClusterer-116"><span class="linenos">116</span></a><span class="sd">    Perform affinity refinement, eigen decomposition and sort eigenvectors by</span>
</span><span id="SpectralClusterer-117"><a href="#SpectralClusterer-117"><span class="linenos">117</span></a><span class="sd">    the real part of eigenvalues. Estimate the number of clusters using EigenGap</span>
</span><span id="SpectralClusterer-118"><a href="#SpectralClusterer-118"><span class="linenos">118</span></a><span class="sd">    principle.</span>
</span><span id="SpectralClusterer-119"><a href="#SpectralClusterer-119"><span class="linenos">119</span></a>
</span><span id="SpectralClusterer-120"><a href="#SpectralClusterer-120"><span class="linenos">120</span></a><span class="sd">    Args:</span>
</span><span id="SpectralClusterer-121"><a href="#SpectralClusterer-121"><span class="linenos">121</span></a><span class="sd">      affinity: the affinity matrix of input data</span>
</span><span id="SpectralClusterer-122"><a href="#SpectralClusterer-122"><span class="linenos">122</span></a><span class="sd">      constraint_matrix: numpy array of shape (n_samples, n_samples). The</span>
</span><span id="SpectralClusterer-123"><a href="#SpectralClusterer-123"><span class="linenos">123</span></a><span class="sd">        constraint matrix with prior information</span>
</span><span id="SpectralClusterer-124"><a href="#SpectralClusterer-124"><span class="linenos">124</span></a>
</span><span id="SpectralClusterer-125"><a href="#SpectralClusterer-125"><span class="linenos">125</span></a><span class="sd">    Returns:</span>
</span><span id="SpectralClusterer-126"><a href="#SpectralClusterer-126"><span class="linenos">126</span></a><span class="sd">      eigenvectors: sorted eigenvectors. numpy array of shape</span>
</span><span id="SpectralClusterer-127"><a href="#SpectralClusterer-127"><span class="linenos">127</span></a><span class="sd">      (n_samples, n_samples)</span>
</span><span id="SpectralClusterer-128"><a href="#SpectralClusterer-128"><span class="linenos">128</span></a><span class="sd">      n_clusters: number of clusters as an integer</span>
</span><span id="SpectralClusterer-129"><a href="#SpectralClusterer-129"><span class="linenos">129</span></a><span class="sd">      max_delta_norm: normalized maximum eigen gap</span>
</span><span id="SpectralClusterer-130"><a href="#SpectralClusterer-130"><span class="linenos">130</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpectralClusterer-131"><a href="#SpectralClusterer-131"><span class="linenos">131</span></a>    <span class="c1"># Perform refinement operations on the affinity matrix.</span>
</span><span id="SpectralClusterer-132"><a href="#SpectralClusterer-132"><span class="linenos">132</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span><span class="o">.</span><span class="n">refinement_sequence</span><span class="p">:</span>
</span><span id="SpectralClusterer-133"><a href="#SpectralClusterer-133"><span class="linenos">133</span></a>      <span class="k">for</span> <span class="n">refinement_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span><span class="o">.</span><span class="n">refinement_sequence</span><span class="p">:</span>
</span><span id="SpectralClusterer-134"><a href="#SpectralClusterer-134"><span class="linenos">134</span></a>        <span class="n">refinement_operator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span><span class="o">.</span><span class="n">get_refinement_operator</span><span class="p">(</span>
</span><span id="SpectralClusterer-135"><a href="#SpectralClusterer-135"><span class="linenos">135</span></a>            <span class="n">refinement_name</span><span class="p">)</span>
</span><span id="SpectralClusterer-136"><a href="#SpectralClusterer-136"><span class="linenos">136</span></a>        <span class="n">affinity</span> <span class="o">=</span> <span class="n">refinement_operator</span><span class="o">.</span><span class="n">refine</span><span class="p">(</span><span class="n">affinity</span><span class="p">)</span>
</span><span id="SpectralClusterer-137"><a href="#SpectralClusterer-137"><span class="linenos">137</span></a>
</span><span id="SpectralClusterer-138"><a href="#SpectralClusterer-138"><span class="linenos">138</span></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span> <span class="ow">and</span>
</span><span id="SpectralClusterer-139"><a href="#SpectralClusterer-139"><span class="linenos">139</span></a>        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span><span class="o">.</span><span class="n">apply_before_refinement</span> <span class="ow">and</span>
</span><span id="SpectralClusterer-140"><a href="#SpectralClusterer-140"><span class="linenos">140</span></a>        <span class="n">constraint_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="SpectralClusterer-141"><a href="#SpectralClusterer-141"><span class="linenos">141</span></a>      <span class="c1"># Perform the constraint operation after refinement</span>
</span><span id="SpectralClusterer-142"><a href="#SpectralClusterer-142"><span class="linenos">142</span></a>      <span class="n">affinity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span><span class="o">.</span><span class="n">constraint_operator</span><span class="o">.</span><span class="n">adjust_affinity</span><span class="p">(</span>
</span><span id="SpectralClusterer-143"><a href="#SpectralClusterer-143"><span class="linenos">143</span></a>          <span class="n">affinity</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span>
</span><span id="SpectralClusterer-144"><a href="#SpectralClusterer-144"><span class="linenos">144</span></a>
</span><span id="SpectralClusterer-145"><a href="#SpectralClusterer-145"><span class="linenos">145</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">laplacian_type</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">laplacian_type</span> <span class="o">==</span> <span class="n">LaplacianType</span><span class="o">.</span><span class="n">Affinity</span><span class="p">:</span>
</span><span id="SpectralClusterer-146"><a href="#SpectralClusterer-146"><span class="linenos">146</span></a>      <span class="c1"># Perform eigen decomposion.</span>
</span><span id="SpectralClusterer-147"><a href="#SpectralClusterer-147"><span class="linenos">147</span></a>      <span class="p">(</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="p">)</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compute_sorted_eigenvectors</span><span class="p">(</span><span class="n">affinity</span><span class="p">)</span>
</span><span id="SpectralClusterer-148"><a href="#SpectralClusterer-148"><span class="linenos">148</span></a>      <span class="c1"># Get number of clusters.</span>
</span><span id="SpectralClusterer-149"><a href="#SpectralClusterer-149"><span class="linenos">149</span></a>      <span class="n">n_clusters</span><span class="p">,</span> <span class="n">max_delta_norm</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compute_number_of_clusters</span><span class="p">(</span>
</span><span id="SpectralClusterer-150"><a href="#SpectralClusterer-150"><span class="linenos">150</span></a>          <span class="n">eigenvalues</span><span class="p">,</span>
</span><span id="SpectralClusterer-151"><a href="#SpectralClusterer-151"><span class="linenos">151</span></a>          <span class="n">max_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span><span class="p">,</span>
</span><span id="SpectralClusterer-152"><a href="#SpectralClusterer-152"><span class="linenos">152</span></a>          <span class="n">stop_eigenvalue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_eigenvalue</span><span class="p">,</span>
</span><span id="SpectralClusterer-153"><a href="#SpectralClusterer-153"><span class="linenos">153</span></a>          <span class="n">eigengap_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eigengap_type</span><span class="p">,</span>
</span><span id="SpectralClusterer-154"><a href="#SpectralClusterer-154"><span class="linenos">154</span></a>          <span class="n">descend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="SpectralClusterer-155"><a href="#SpectralClusterer-155"><span class="linenos">155</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer-156"><a href="#SpectralClusterer-156"><span class="linenos">156</span></a>      <span class="c1"># Compute Laplacian matrix</span>
</span><span id="SpectralClusterer-157"><a href="#SpectralClusterer-157"><span class="linenos">157</span></a>      <span class="n">laplacian_norm</span> <span class="o">=</span> <span class="n">laplacian</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span>
</span><span id="SpectralClusterer-158"><a href="#SpectralClusterer-158"><span class="linenos">158</span></a>          <span class="n">affinity</span><span class="p">,</span> <span class="n">laplacian_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">laplacian_type</span><span class="p">)</span>
</span><span id="SpectralClusterer-159"><a href="#SpectralClusterer-159"><span class="linenos">159</span></a>      <span class="c1"># Perform eigen decomposion. Eigen values are sorted in an ascending</span>
</span><span id="SpectralClusterer-160"><a href="#SpectralClusterer-160"><span class="linenos">160</span></a>      <span class="c1"># order</span>
</span><span id="SpectralClusterer-161"><a href="#SpectralClusterer-161"><span class="linenos">161</span></a>      <span class="p">(</span><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="p">)</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compute_sorted_eigenvectors</span><span class="p">(</span>
</span><span id="SpectralClusterer-162"><a href="#SpectralClusterer-162"><span class="linenos">162</span></a>          <span class="n">laplacian_norm</span><span class="p">,</span> <span class="n">descend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="SpectralClusterer-163"><a href="#SpectralClusterer-163"><span class="linenos">163</span></a>      <span class="c1"># Get number of clusters. Eigen values are sorted in an ascending order</span>
</span><span id="SpectralClusterer-164"><a href="#SpectralClusterer-164"><span class="linenos">164</span></a>      <span class="n">n_clusters</span><span class="p">,</span> <span class="n">max_delta_norm</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compute_number_of_clusters</span><span class="p">(</span>
</span><span id="SpectralClusterer-165"><a href="#SpectralClusterer-165"><span class="linenos">165</span></a>          <span class="n">eigenvalues</span><span class="p">,</span>
</span><span id="SpectralClusterer-166"><a href="#SpectralClusterer-166"><span class="linenos">166</span></a>          <span class="n">max_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span><span class="p">,</span>
</span><span id="SpectralClusterer-167"><a href="#SpectralClusterer-167"><span class="linenos">167</span></a>          <span class="n">eigengap_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eigengap_type</span><span class="p">,</span>
</span><span id="SpectralClusterer-168"><a href="#SpectralClusterer-168"><span class="linenos">168</span></a>          <span class="n">descend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="SpectralClusterer-169"><a href="#SpectralClusterer-169"><span class="linenos">169</span></a>    <span class="k">return</span> <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">max_delta_norm</span>
</span><span id="SpectralClusterer-170"><a href="#SpectralClusterer-170"><span class="linenos">170</span></a>
</span><span id="SpectralClusterer-171"><a href="#SpectralClusterer-171"><span class="linenos">171</span></a>  <span class="k">def</span> <span class="nf">_reduce_size_and_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="SpectralClusterer-172"><a href="#SpectralClusterer-172"><span class="linenos">172</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduce the input size, then run spectral clustering.</span>
</span><span id="SpectralClusterer-173"><a href="#SpectralClusterer-173"><span class="linenos">173</span></a>
</span><span id="SpectralClusterer-174"><a href="#SpectralClusterer-174"><span class="linenos">174</span></a><span class="sd">    Args:</span>
</span><span id="SpectralClusterer-175"><a href="#SpectralClusterer-175"><span class="linenos">175</span></a><span class="sd">      embeddings: numpy array of shape (n_samples, n_features)</span>
</span><span id="SpectralClusterer-176"><a href="#SpectralClusterer-176"><span class="linenos">176</span></a>
</span><span id="SpectralClusterer-177"><a href="#SpectralClusterer-177"><span class="linenos">177</span></a><span class="sd">    Returns:</span>
</span><span id="SpectralClusterer-178"><a href="#SpectralClusterer-178"><span class="linenos">178</span></a><span class="sd">      labels: numpy array of shape (n_samples,)</span>
</span><span id="SpectralClusterer-179"><a href="#SpectralClusterer-179"><span class="linenos">179</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpectralClusterer-180"><a href="#SpectralClusterer-180"><span class="linenos">180</span></a>    <span class="c1"># Run AHC on the input to reduce the size.</span>
</span><span id="SpectralClusterer-181"><a href="#SpectralClusterer-181"><span class="linenos">181</span></a>    <span class="c1"># Note that linkage needs to be &quot;complete&quot;, because &quot;average&quot; and &quot;single&quot;</span>
</span><span id="SpectralClusterer-182"><a href="#SpectralClusterer-182"><span class="linenos">182</span></a>    <span class="c1"># do not work very well here.</span>
</span><span id="SpectralClusterer-183"><a href="#SpectralClusterer-183"><span class="linenos">183</span></a>    <span class="c1"># Alternatively, we can use &quot;euclidean&quot; and &quot;ward&quot;, but that requires</span>
</span><span id="SpectralClusterer-184"><a href="#SpectralClusterer-184"><span class="linenos">184</span></a>    <span class="c1"># that the inputs are L2 normalized first.</span>
</span><span id="SpectralClusterer-185"><a href="#SpectralClusterer-185"><span class="linenos">185</span></a>    <span class="n">ahc</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span><span class="p">(</span>
</span><span id="SpectralClusterer-186"><a href="#SpectralClusterer-186"><span class="linenos">186</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span><span class="p">,</span>
</span><span id="SpectralClusterer-187"><a href="#SpectralClusterer-187"><span class="linenos">187</span></a>        <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">,</span>
</span><span id="SpectralClusterer-188"><a href="#SpectralClusterer-188"><span class="linenos">188</span></a>        <span class="n">linkage</span><span class="o">=</span><span class="s2">&quot;complete&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer-189"><a href="#SpectralClusterer-189"><span class="linenos">189</span></a>    <span class="n">ahc_labels</span> <span class="o">=</span> <span class="n">ahc</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer-190"><a href="#SpectralClusterer-190"><span class="linenos">190</span></a>
</span><span id="SpectralClusterer-191"><a href="#SpectralClusterer-191"><span class="linenos">191</span></a>    <span class="c1"># Compute the centroids of the AHC clusters.</span>
</span><span id="SpectralClusterer-192"><a href="#SpectralClusterer-192"><span class="linenos">192</span></a>    <span class="n">ahc_centroids</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_cluster_centroids</span><span class="p">(</span><span class="n">embeddings</span><span class="p">,</span> <span class="n">ahc_labels</span><span class="p">)</span>
</span><span id="SpectralClusterer-193"><a href="#SpectralClusterer-193"><span class="linenos">193</span></a>
</span><span id="SpectralClusterer-194"><a href="#SpectralClusterer-194"><span class="linenos">194</span></a>    <span class="c1"># Run spectral clustering on AHC centroids.</span>
</span><span id="SpectralClusterer-195"><a href="#SpectralClusterer-195"><span class="linenos">195</span></a>    <span class="n">spectral_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">ahc_centroids</span><span class="p">)</span>
</span><span id="SpectralClusterer-196"><a href="#SpectralClusterer-196"><span class="linenos">196</span></a>
</span><span id="SpectralClusterer-197"><a href="#SpectralClusterer-197"><span class="linenos">197</span></a>    <span class="c1"># Convert spectral labels to final labels.</span>
</span><span id="SpectralClusterer-198"><a href="#SpectralClusterer-198"><span class="linenos">198</span></a>    <span class="n">final_labels</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">chain_labels</span><span class="p">(</span><span class="n">ahc_labels</span><span class="p">,</span> <span class="n">spectral_labels</span><span class="p">)</span>
</span><span id="SpectralClusterer-199"><a href="#SpectralClusterer-199"><span class="linenos">199</span></a>
</span><span id="SpectralClusterer-200"><a href="#SpectralClusterer-200"><span class="linenos">200</span></a>    <span class="k">return</span> <span class="n">final_labels</span>
</span><span id="SpectralClusterer-201"><a href="#SpectralClusterer-201"><span class="linenos">201</span></a>
</span><span id="SpectralClusterer-202"><a href="#SpectralClusterer-202"><span class="linenos">202</span></a>  <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
</span><span id="SpectralClusterer-203"><a href="#SpectralClusterer-203"><span class="linenos">203</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="SpectralClusterer-204"><a href="#SpectralClusterer-204"><span class="linenos">204</span></a>      <span class="n">embeddings</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="SpectralClusterer-205"><a href="#SpectralClusterer-205"><span class="linenos">205</span></a>      <span class="n">constraint_matrix</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="SpectralClusterer-206"><a href="#SpectralClusterer-206"><span class="linenos">206</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform spectral clustering on data embeddings.</span>
</span><span id="SpectralClusterer-207"><a href="#SpectralClusterer-207"><span class="linenos">207</span></a>
</span><span id="SpectralClusterer-208"><a href="#SpectralClusterer-208"><span class="linenos">208</span></a><span class="sd">    The spectral clustering is performed on an affinity matrix.</span>
</span><span id="SpectralClusterer-209"><a href="#SpectralClusterer-209"><span class="linenos">209</span></a>
</span><span id="SpectralClusterer-210"><a href="#SpectralClusterer-210"><span class="linenos">210</span></a><span class="sd">    Args:</span>
</span><span id="SpectralClusterer-211"><a href="#SpectralClusterer-211"><span class="linenos">211</span></a><span class="sd">      embeddings: numpy array of shape (n_samples, n_features)</span>
</span><span id="SpectralClusterer-212"><a href="#SpectralClusterer-212"><span class="linenos">212</span></a><span class="sd">      constraint_matrix: numpy array of shape (n_samples, n_samples). The</span>
</span><span id="SpectralClusterer-213"><a href="#SpectralClusterer-213"><span class="linenos">213</span></a><span class="sd">        constraint matrix with prior information</span>
</span><span id="SpectralClusterer-214"><a href="#SpectralClusterer-214"><span class="linenos">214</span></a>
</span><span id="SpectralClusterer-215"><a href="#SpectralClusterer-215"><span class="linenos">215</span></a><span class="sd">    Returns:</span>
</span><span id="SpectralClusterer-216"><a href="#SpectralClusterer-216"><span class="linenos">216</span></a><span class="sd">      labels: numpy array of shape (n_samples,)</span>
</span><span id="SpectralClusterer-217"><a href="#SpectralClusterer-217"><span class="linenos">217</span></a>
</span><span id="SpectralClusterer-218"><a href="#SpectralClusterer-218"><span class="linenos">218</span></a><span class="sd">    Raises:</span>
</span><span id="SpectralClusterer-219"><a href="#SpectralClusterer-219"><span class="linenos">219</span></a><span class="sd">      TypeError: if embeddings has wrong type</span>
</span><span id="SpectralClusterer-220"><a href="#SpectralClusterer-220"><span class="linenos">220</span></a><span class="sd">      ValueError: if embeddings has wrong shape</span>
</span><span id="SpectralClusterer-221"><a href="#SpectralClusterer-221"><span class="linenos">221</span></a><span class="sd">      RuntimeError: if max_spectral_size is set and constraint_matrix is given</span>
</span><span id="SpectralClusterer-222"><a href="#SpectralClusterer-222"><span class="linenos">222</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpectralClusterer-223"><a href="#SpectralClusterer-223"><span class="linenos">223</span></a>    <span class="n">num_embeddings</span> <span class="o">=</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpectralClusterer-224"><a href="#SpectralClusterer-224"><span class="linenos">224</span></a>
</span><span id="SpectralClusterer-225"><a href="#SpectralClusterer-225"><span class="linenos">225</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">embeddings</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="SpectralClusterer-226"><a href="#SpectralClusterer-226"><span class="linenos">226</span></a>      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;embeddings must be a numpy array&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer-227"><a href="#SpectralClusterer-227"><span class="linenos">227</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SpectralClusterer-228"><a href="#SpectralClusterer-228"><span class="linenos">228</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;embeddings must be 2-dimensional&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer-229"><a href="#SpectralClusterer-229"><span class="linenos">229</span></a>
</span><span id="SpectralClusterer-230"><a href="#SpectralClusterer-230"><span class="linenos">230</span></a>    <span class="c1"># Check whether we need to run fallback clusterer instead.</span>
</span><span id="SpectralClusterer-231"><a href="#SpectralClusterer-231"><span class="linenos">231</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_embeddings</span> <span class="o">&lt;</span>
</span><span id="SpectralClusterer-232"><a href="#SpectralClusterer-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span><span class="o">.</span><span class="n">spectral_min_embeddings</span><span class="p">):</span>
</span><span id="SpectralClusterer-233"><a href="#SpectralClusterer-233"><span class="linenos">233</span></a>      <span class="n">temp_clusterer</span> <span class="o">=</span> <span class="n">fallback_clusterer</span><span class="o">.</span><span class="n">FallbackClusterer</span><span class="p">(</span>
</span><span id="SpectralClusterer-234"><a href="#SpectralClusterer-234"><span class="linenos">234</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span><span class="p">)</span>
</span><span id="SpectralClusterer-235"><a href="#SpectralClusterer-235"><span class="linenos">235</span></a>      <span class="k">return</span> <span class="n">temp_clusterer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer-236"><a href="#SpectralClusterer-236"><span class="linenos">236</span></a>
</span><span id="SpectralClusterer-237"><a href="#SpectralClusterer-237"><span class="linenos">237</span></a>    <span class="c1"># Check whether the input size is too big for running spectral clustering.</span>
</span><span id="SpectralClusterer-238"><a href="#SpectralClusterer-238"><span class="linenos">238</span></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="SpectralClusterer-239"><a href="#SpectralClusterer-239"><span class="linenos">239</span></a>        <span class="ow">and</span> <span class="n">num_embeddings</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span><span class="p">):</span>
</span><span id="SpectralClusterer-240"><a href="#SpectralClusterer-240"><span class="linenos">240</span></a>      <span class="k">if</span> <span class="n">constraint_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpectralClusterer-241"><a href="#SpectralClusterer-241"><span class="linenos">241</span></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
</span><span id="SpectralClusterer-242"><a href="#SpectralClusterer-242"><span class="linenos">242</span></a>            <span class="s2">&quot;Cannot handle constraint_matrix when max_spectral_size is set&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer-243"><a href="#SpectralClusterer-243"><span class="linenos">243</span></a>      <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span>
</span><span id="SpectralClusterer-244"><a href="#SpectralClusterer-244"><span class="linenos">244</span></a>         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="SpectralClusterer-245"><a href="#SpectralClusterer-245"><span class="linenos">245</span></a>         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span><span class="p">)):</span>
</span><span id="SpectralClusterer-246"><a href="#SpectralClusterer-246"><span class="linenos">246</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="SpectralClusterer-247"><a href="#SpectralClusterer-247"><span class="linenos">247</span></a>            <span class="s2">&quot;max_spectral_size should be a relatively big number&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer-248"><a href="#SpectralClusterer-248"><span class="linenos">248</span></a>      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reduce_size_and_predict</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer-249"><a href="#SpectralClusterer-249"><span class="linenos">249</span></a>
</span><span id="SpectralClusterer-250"><a href="#SpectralClusterer-250"><span class="linenos">250</span></a>    <span class="c1"># Compute affinity matrix.</span>
</span><span id="SpectralClusterer-251"><a href="#SpectralClusterer-251"><span class="linenos">251</span></a>    <span class="n">affinity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">affinity_function</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer-252"><a href="#SpectralClusterer-252"><span class="linenos">252</span></a>
</span><span id="SpectralClusterer-253"><a href="#SpectralClusterer-253"><span class="linenos">253</span></a>    <span class="c1"># Make single-vs-multi cluster(s) decision.</span>
</span><span id="SpectralClusterer-254"><a href="#SpectralClusterer-254"><span class="linenos">254</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpectralClusterer-255"><a href="#SpectralClusterer-255"><span class="linenos">255</span></a>      <span class="k">if</span> <span class="n">fallback_clusterer</span><span class="o">.</span><span class="n">check_single_cluster</span><span class="p">(</span>
</span><span id="SpectralClusterer-256"><a href="#SpectralClusterer-256"><span class="linenos">256</span></a>              <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">,</span> <span class="n">affinity</span><span class="p">):</span>
</span><span id="SpectralClusterer-257"><a href="#SpectralClusterer-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer-258"><a href="#SpectralClusterer-258"><span class="linenos">258</span></a>
</span><span id="SpectralClusterer-259"><a href="#SpectralClusterer-259"><span class="linenos">259</span></a>    <span class="c1"># Apply constraint.</span>
</span><span id="SpectralClusterer-260"><a href="#SpectralClusterer-260"><span class="linenos">260</span></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span> <span class="ow">and</span>
</span><span id="SpectralClusterer-261"><a href="#SpectralClusterer-261"><span class="linenos">261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span><span class="o">.</span><span class="n">apply_before_refinement</span> <span class="ow">and</span>
</span><span id="SpectralClusterer-262"><a href="#SpectralClusterer-262"><span class="linenos">262</span></a>        <span class="n">constraint_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="SpectralClusterer-263"><a href="#SpectralClusterer-263"><span class="linenos">263</span></a>      <span class="c1"># Perform the constraint operation before refinement</span>
</span><span id="SpectralClusterer-264"><a href="#SpectralClusterer-264"><span class="linenos">264</span></a>      <span class="n">affinity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span><span class="o">.</span><span class="n">constraint_operator</span><span class="o">.</span><span class="n">adjust_affinity</span><span class="p">(</span>
</span><span id="SpectralClusterer-265"><a href="#SpectralClusterer-265"><span class="linenos">265</span></a>          <span class="n">affinity</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span>
</span><span id="SpectralClusterer-266"><a href="#SpectralClusterer-266"><span class="linenos">266</span></a>
</span><span id="SpectralClusterer-267"><a href="#SpectralClusterer-267"><span class="linenos">267</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="p">:</span>
</span><span id="SpectralClusterer-268"><a href="#SpectralClusterer-268"><span class="linenos">268</span></a>      <span class="c1"># Use Auto-tuning method to find a good p_percentile.</span>
</span><span id="SpectralClusterer-269"><a href="#SpectralClusterer-269"><span class="linenos">269</span></a>      <span class="k">if</span> <span class="p">(</span><span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseThreshold</span>
</span><span id="SpectralClusterer-270"><a href="#SpectralClusterer-270"><span class="linenos">270</span></a>          <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span><span class="o">.</span><span class="n">refinement_sequence</span><span class="p">):</span>
</span><span id="SpectralClusterer-271"><a href="#SpectralClusterer-271"><span class="linenos">271</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="SpectralClusterer-272"><a href="#SpectralClusterer-272"><span class="linenos">272</span></a>            <span class="s2">&quot;AutoTune is only effective when the refinement sequence&quot;</span>
</span><span id="SpectralClusterer-273"><a href="#SpectralClusterer-273"><span class="linenos">273</span></a>            <span class="s2">&quot;contains RowWiseThreshold&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer-274"><a href="#SpectralClusterer-274"><span class="linenos">274</span></a>
</span><span id="SpectralClusterer-275"><a href="#SpectralClusterer-275"><span class="linenos">275</span></a>      <span class="k">def</span> <span class="nf">p_percentile_to_ratio</span><span class="p">(</span><span class="n">p_percentile</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
</span><span id="SpectralClusterer-276"><a href="#SpectralClusterer-276"><span class="linenos">276</span></a>          <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
</span><span id="SpectralClusterer-277"><a href="#SpectralClusterer-277"><span class="linenos">277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the `ratio` given a `p_percentile` value.&quot;&quot;&quot;</span>
</span><span id="SpectralClusterer-278"><a href="#SpectralClusterer-278"><span class="linenos">278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span><span class="o">.</span><span class="n">p_percentile</span> <span class="o">=</span> <span class="n">p_percentile</span>
</span><span id="SpectralClusterer-279"><a href="#SpectralClusterer-279"><span class="linenos">279</span></a>        <span class="p">(</span><span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span>
</span><span id="SpectralClusterer-280"><a href="#SpectralClusterer-280"><span class="linenos">280</span></a>         <span class="n">max_delta_norm</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_eigenvectors_ncluster</span><span class="p">(</span>
</span><span id="SpectralClusterer-281"><a href="#SpectralClusterer-281"><span class="linenos">281</span></a>             <span class="n">affinity</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span>
</span><span id="SpectralClusterer-282"><a href="#SpectralClusterer-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="o">.</span><span class="n">proxy</span> <span class="o">==</span> <span class="n">AutoTuneProxy</span><span class="o">.</span><span class="n">PercentileSqrtOverNME</span><span class="p">:</span>
</span><span id="SpectralClusterer-283"><a href="#SpectralClusterer-283"><span class="linenos">283</span></a>          <span class="n">ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_percentile</span><span class="p">)</span> <span class="o">/</span> <span class="n">max_delta_norm</span>
</span><span id="SpectralClusterer-284"><a href="#SpectralClusterer-284"><span class="linenos">284</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="o">.</span><span class="n">proxy</span> <span class="o">==</span> <span class="n">AutoTuneProxy</span><span class="o">.</span><span class="n">PercentileSqrtOverNME</span><span class="p">:</span>
</span><span id="SpectralClusterer-285"><a href="#SpectralClusterer-285"><span class="linenos">285</span></a>          <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_percentile</span><span class="p">)</span> <span class="o">/</span> <span class="n">max_delta_norm</span>
</span><span id="SpectralClusterer-286"><a href="#SpectralClusterer-286"><span class="linenos">286</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer-287"><a href="#SpectralClusterer-287"><span class="linenos">287</span></a>          <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported value of AutoTuneProxy&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer-288"><a href="#SpectralClusterer-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span>
</span><span id="SpectralClusterer-289"><a href="#SpectralClusterer-289"><span class="linenos">289</span></a>
</span><span id="SpectralClusterer-290"><a href="#SpectralClusterer-290"><span class="linenos">290</span></a>      <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">p_percentile_to_ratio</span><span class="p">)</span>
</span><span id="SpectralClusterer-291"><a href="#SpectralClusterer-291"><span class="linenos">291</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer-292"><a href="#SpectralClusterer-292"><span class="linenos">292</span></a>      <span class="c1"># Do not use Auto-tune.</span>
</span><span id="SpectralClusterer-293"><a href="#SpectralClusterer-293"><span class="linenos">293</span></a>      <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_eigenvectors_ncluster</span><span class="p">(</span>
</span><span id="SpectralClusterer-294"><a href="#SpectralClusterer-294"><span class="linenos">294</span></a>          <span class="n">affinity</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span>
</span><span id="SpectralClusterer-295"><a href="#SpectralClusterer-295"><span class="linenos">295</span></a>
</span><span id="SpectralClusterer-296"><a href="#SpectralClusterer-296"><span class="linenos">296</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpectralClusterer-297"><a href="#SpectralClusterer-297"><span class="linenos">297</span></a>      <span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span><span class="p">)</span>
</span><span id="SpectralClusterer-298"><a href="#SpectralClusterer-298"><span class="linenos">298</span></a>
</span><span id="SpectralClusterer-299"><a href="#SpectralClusterer-299"><span class="linenos">299</span></a>    <span class="c1"># Get spectral embeddings.</span>
</span><span id="SpectralClusterer-300"><a href="#SpectralClusterer-300"><span class="linenos">300</span></a>    <span class="n">spectral_embeddings</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_clusters</span><span class="p">]</span>
</span><span id="SpectralClusterer-301"><a href="#SpectralClusterer-301"><span class="linenos">301</span></a>
</span><span id="SpectralClusterer-302"><a href="#SpectralClusterer-302"><span class="linenos">302</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_wise_renorm</span><span class="p">:</span>
</span><span id="SpectralClusterer-303"><a href="#SpectralClusterer-303"><span class="linenos">303</span></a>      <span class="c1"># Perform row wise re-normalization.</span>
</span><span id="SpectralClusterer-304"><a href="#SpectralClusterer-304"><span class="linenos">304</span></a>      <span class="n">rows_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">spectral_embeddings</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="SpectralClusterer-305"><a href="#SpectralClusterer-305"><span class="linenos">305</span></a>      <span class="n">spectral_embeddings</span> <span class="o">=</span> <span class="n">spectral_embeddings</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="SpectralClusterer-306"><a href="#SpectralClusterer-306"><span class="linenos">306</span></a>          <span class="n">rows_norm</span><span class="p">,</span> <span class="p">(</span><span class="n">num_embeddings</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="SpectralClusterer-307"><a href="#SpectralClusterer-307"><span class="linenos">307</span></a>
</span><span id="SpectralClusterer-308"><a href="#SpectralClusterer-308"><span class="linenos">308</span></a>    <span class="c1"># Run clustering algorithm on spectral embeddings. This defaults</span>
</span><span id="SpectralClusterer-309"><a href="#SpectralClusterer-309"><span class="linenos">309</span></a>    <span class="c1"># to customized K-means.</span>
</span><span id="SpectralClusterer-310"><a href="#SpectralClusterer-310"><span class="linenos">310</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">post_eigen_cluster_function</span><span class="p">(</span>
</span><span id="SpectralClusterer-311"><a href="#SpectralClusterer-311"><span class="linenos">311</span></a>        <span class="n">spectral_embeddings</span><span class="o">=</span><span class="n">spectral_embeddings</span><span class="p">,</span>
</span><span id="SpectralClusterer-312"><a href="#SpectralClusterer-312"><span class="linenos">312</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="SpectralClusterer-313"><a href="#SpectralClusterer-313"><span class="linenos">313</span></a>        <span class="n">custom_dist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_dist</span><span class="p">,</span>
</span><span id="SpectralClusterer-314"><a href="#SpectralClusterer-314"><span class="linenos">314</span></a>        <span class="n">max_iter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">)</span>
</span><span id="SpectralClusterer-315"><a href="#SpectralClusterer-315"><span class="linenos">315</span></a>    <span class="k">return</span> <span class="n">labels</span>
</span></pre></div>


            <div class="docstring"><p>Spectral clustering class.</p>
</div>


                            <div id="SpectralClusterer.__init__" class="classattr">
                                        <input id="SpectralClusterer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">SpectralClusterer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">min_clusters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">max_clusters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">refinement_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="#RefinementOptions">spectralcluster.configs.RefinementOptions</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">autotune</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="#AutoTune">spectralcluster.configs.AutoTune</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fallback_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="fallback_clusterer.html#FallbackOptions">spectralcluster.fallback_clusterer.FallbackOptions</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">laplacian_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="#LaplacianType">spectralcluster.configs.LaplacianType</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stop_eigenvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>,</span><span class="param">	<span class="n">row_wise_renorm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">custom_dist</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cosine&#39;</span>,</span><span class="param">	<span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span>,</span><span class="param">	<span class="n">constraint_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="#ConstraintOptions">spectralcluster.configs.ConstraintOptions</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">eigengap_type</span><span class="p">:</span> <span class="n"><a href="utils.html#EigenGapType">spectralcluster.utils.EigenGapType</a></span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">EigenGapType</span><span class="o">.</span><span class="n">Ratio</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">max_spectral_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">affinity_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">compute_affinity_matrix</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">post_eigen_cluster_function</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">run_kmeans</span><span class="o">&gt;</span></span>)</span>

                <label class="view-source-button" for="SpectralClusterer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpectralClusterer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpectralClusterer.__init__-30"><a href="#SpectralClusterer.__init__-30"><span class="linenos"> 30</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SpectralClusterer.__init__-31"><a href="#SpectralClusterer.__init__-31"><span class="linenos"> 31</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-32"><a href="#SpectralClusterer.__init__-32"><span class="linenos"> 32</span></a>      <span class="n">min_clusters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-33"><a href="#SpectralClusterer.__init__-33"><span class="linenos"> 33</span></a>      <span class="n">max_clusters</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-34"><a href="#SpectralClusterer.__init__-34"><span class="linenos"> 34</span></a>      <span class="n">refinement_options</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">RefinementOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-35"><a href="#SpectralClusterer.__init__-35"><span class="linenos"> 35</span></a>      <span class="n">autotune</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">AutoTune</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-36"><a href="#SpectralClusterer.__init__-36"><span class="linenos"> 36</span></a>      <span class="n">fallback_options</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">FallbackOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-37"><a href="#SpectralClusterer.__init__-37"><span class="linenos"> 37</span></a>      <span class="n">laplacian_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">LaplacianType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-38"><a href="#SpectralClusterer.__init__-38"><span class="linenos"> 38</span></a>      <span class="n">stop_eigenvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-39"><a href="#SpectralClusterer.__init__-39"><span class="linenos"> 39</span></a>      <span class="n">row_wise_renorm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-40"><a href="#SpectralClusterer.__init__-40"><span class="linenos"> 40</span></a>      <span class="n">custom_dist</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cosine&quot;</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-41"><a href="#SpectralClusterer.__init__-41"><span class="linenos"> 41</span></a>      <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-42"><a href="#SpectralClusterer.__init__-42"><span class="linenos"> 42</span></a>      <span class="n">constraint_options</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">ConstraintOptions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-43"><a href="#SpectralClusterer.__init__-43"><span class="linenos"> 43</span></a>      <span class="n">eigengap_type</span><span class="p">:</span> <span class="n">EigenGapType</span> <span class="o">=</span> <span class="n">EigenGapType</span><span class="o">.</span><span class="n">Ratio</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-44"><a href="#SpectralClusterer.__init__-44"><span class="linenos"> 44</span></a>      <span class="n">max_spectral_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-45"><a href="#SpectralClusterer.__init__-45"><span class="linenos"> 45</span></a>      <span class="n">affinity_function</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">compute_affinity_matrix</span><span class="p">,</span>
</span><span id="SpectralClusterer.__init__-46"><a href="#SpectralClusterer.__init__-46"><span class="linenos"> 46</span></a>      <span class="n">post_eigen_cluster_function</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Callable</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="SpectralClusterer.__init__-47"><a href="#SpectralClusterer.__init__-47"><span class="linenos"> 47</span></a>          <span class="n">custom_distance_kmeans</span><span class="o">.</span><span class="n">run_kmeans</span><span class="p">)):</span>
</span><span id="SpectralClusterer.__init__-48"><a href="#SpectralClusterer.__init__-48"><span class="linenos"> 48</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor of the clusterer.</span>
</span><span id="SpectralClusterer.__init__-49"><a href="#SpectralClusterer.__init__-49"><span class="linenos"> 49</span></a>
</span><span id="SpectralClusterer.__init__-50"><a href="#SpectralClusterer.__init__-50"><span class="linenos"> 50</span></a><span class="sd">    Args:</span>
</span><span id="SpectralClusterer.__init__-51"><a href="#SpectralClusterer.__init__-51"><span class="linenos"> 51</span></a><span class="sd">      min_clusters: minimal number of clusters allowed (only effective if not</span>
</span><span id="SpectralClusterer.__init__-52"><a href="#SpectralClusterer.__init__-52"><span class="linenos"> 52</span></a><span class="sd">        None)</span>
</span><span id="SpectralClusterer.__init__-53"><a href="#SpectralClusterer.__init__-53"><span class="linenos"> 53</span></a><span class="sd">      max_clusters: maximal number of clusters allowed (only effective if not</span>
</span><span id="SpectralClusterer.__init__-54"><a href="#SpectralClusterer.__init__-54"><span class="linenos"> 54</span></a><span class="sd">        None), can be used together with min_clusters to fix the number of</span>
</span><span id="SpectralClusterer.__init__-55"><a href="#SpectralClusterer.__init__-55"><span class="linenos"> 55</span></a><span class="sd">        clusters</span>
</span><span id="SpectralClusterer.__init__-56"><a href="#SpectralClusterer.__init__-56"><span class="linenos"> 56</span></a><span class="sd">      refinement_options: a RefinementOptions object that contains refinement</span>
</span><span id="SpectralClusterer.__init__-57"><a href="#SpectralClusterer.__init__-57"><span class="linenos"> 57</span></a><span class="sd">        arguments for the affinity matrix. If None, we will not refine</span>
</span><span id="SpectralClusterer.__init__-58"><a href="#SpectralClusterer.__init__-58"><span class="linenos"> 58</span></a><span class="sd">      autotune: an AutoTune object to automatically search p_percentile</span>
</span><span id="SpectralClusterer.__init__-59"><a href="#SpectralClusterer.__init__-59"><span class="linenos"> 59</span></a><span class="sd">      fallback_options: a FallbackOptions object to indicate when to run</span>
</span><span id="SpectralClusterer.__init__-60"><a href="#SpectralClusterer.__init__-60"><span class="linenos"> 60</span></a><span class="sd">        fallback clusterer instead of spectral clusterer</span>
</span><span id="SpectralClusterer.__init__-61"><a href="#SpectralClusterer.__init__-61"><span class="linenos"> 61</span></a><span class="sd">      laplacian_type: a LaplacianType. If None, we do not use a laplacian matrix</span>
</span><span id="SpectralClusterer.__init__-62"><a href="#SpectralClusterer.__init__-62"><span class="linenos"> 62</span></a><span class="sd">      stop_eigenvalue: when computing the number of clusters using Eigen Gap, we</span>
</span><span id="SpectralClusterer.__init__-63"><a href="#SpectralClusterer.__init__-63"><span class="linenos"> 63</span></a><span class="sd">        do not look at eigen values smaller than this value</span>
</span><span id="SpectralClusterer.__init__-64"><a href="#SpectralClusterer.__init__-64"><span class="linenos"> 64</span></a><span class="sd">      row_wise_renorm: if True, perform row-wise re-normalization on the</span>
</span><span id="SpectralClusterer.__init__-65"><a href="#SpectralClusterer.__init__-65"><span class="linenos"> 65</span></a><span class="sd">        spectral embeddings</span>
</span><span id="SpectralClusterer.__init__-66"><a href="#SpectralClusterer.__init__-66"><span class="linenos"> 66</span></a><span class="sd">      custom_dist: str or callable. custom distance measure for k-means. If a</span>
</span><span id="SpectralClusterer.__init__-67"><a href="#SpectralClusterer.__init__-67"><span class="linenos"> 67</span></a><span class="sd">        string, &quot;cosine&quot;, &quot;euclidean&quot;, &quot;mahalanobis&quot;, or any other distance</span>
</span><span id="SpectralClusterer.__init__-68"><a href="#SpectralClusterer.__init__-68"><span class="linenos"> 68</span></a><span class="sd">        functions defined in scipy.spatial.distance can be used</span>
</span><span id="SpectralClusterer.__init__-69"><a href="#SpectralClusterer.__init__-69"><span class="linenos"> 69</span></a><span class="sd">      max_iter: the maximum number of iterations for the custom k-means</span>
</span><span id="SpectralClusterer.__init__-70"><a href="#SpectralClusterer.__init__-70"><span class="linenos"> 70</span></a><span class="sd">      constraint_options: a ConstraintOptions object that contains constraint</span>
</span><span id="SpectralClusterer.__init__-71"><a href="#SpectralClusterer.__init__-71"><span class="linenos"> 71</span></a><span class="sd">        arguments</span>
</span><span id="SpectralClusterer.__init__-72"><a href="#SpectralClusterer.__init__-72"><span class="linenos"> 72</span></a><span class="sd">      eigengap_type: the type of the eigengap computation</span>
</span><span id="SpectralClusterer.__init__-73"><a href="#SpectralClusterer.__init__-73"><span class="linenos"> 73</span></a><span class="sd">      max_spectral_size: the maximal size of input to the spectral clustering</span>
</span><span id="SpectralClusterer.__init__-74"><a href="#SpectralClusterer.__init__-74"><span class="linenos"> 74</span></a><span class="sd">        algorithm. If this is set, and the actual input size is larger than</span>
</span><span id="SpectralClusterer.__init__-75"><a href="#SpectralClusterer.__init__-75"><span class="linenos"> 75</span></a><span class="sd">        this value, then we are going to first use hierarchical clustering</span>
</span><span id="SpectralClusterer.__init__-76"><a href="#SpectralClusterer.__init__-76"><span class="linenos"> 76</span></a><span class="sd">        to reduce the input size to this number. This can significantly reduce</span>
</span><span id="SpectralClusterer.__init__-77"><a href="#SpectralClusterer.__init__-77"><span class="linenos"> 77</span></a><span class="sd">        the computational cost for steps like Laplacian matrix and eigen</span>
</span><span id="SpectralClusterer.__init__-78"><a href="#SpectralClusterer.__init__-78"><span class="linenos"> 78</span></a><span class="sd">        decomposition. However, please note that this may degrade the quality</span>
</span><span id="SpectralClusterer.__init__-79"><a href="#SpectralClusterer.__init__-79"><span class="linenos"> 79</span></a><span class="sd">        of the final clustering results. This corresponds to the U1 value in</span>
</span><span id="SpectralClusterer.__init__-80"><a href="#SpectralClusterer.__init__-80"><span class="linenos"> 80</span></a><span class="sd">        the multi-stage clustering paper (https://arxiv.org/abs/2210.13690)</span>
</span><span id="SpectralClusterer.__init__-81"><a href="#SpectralClusterer.__init__-81"><span class="linenos"> 81</span></a><span class="sd">      affinity_function: a function to compute the affinity matrix from the</span>
</span><span id="SpectralClusterer.__init__-82"><a href="#SpectralClusterer.__init__-82"><span class="linenos"> 82</span></a><span class="sd">        embeddings. This defaults to (cos(x,y)+1)/2</span>
</span><span id="SpectralClusterer.__init__-83"><a href="#SpectralClusterer.__init__-83"><span class="linenos"> 83</span></a><span class="sd">      post_eigen_cluster_function: a function to cluster the spectral embeddings</span>
</span><span id="SpectralClusterer.__init__-84"><a href="#SpectralClusterer.__init__-84"><span class="linenos"> 84</span></a><span class="sd">        after the eigenvalue computations. This function must have the same</span>
</span><span id="SpectralClusterer.__init__-85"><a href="#SpectralClusterer.__init__-85"><span class="linenos"> 85</span></a><span class="sd">        signature as custom_distance_kmeans.run_kmeans</span>
</span><span id="SpectralClusterer.__init__-86"><a href="#SpectralClusterer.__init__-86"><span class="linenos"> 86</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpectralClusterer.__init__-87"><a href="#SpectralClusterer.__init__-87"><span class="linenos"> 87</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="o">=</span> <span class="n">min_clusters</span>
</span><span id="SpectralClusterer.__init__-88"><a href="#SpectralClusterer.__init__-88"><span class="linenos"> 88</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span> <span class="o">=</span> <span class="n">max_clusters</span>
</span><span id="SpectralClusterer.__init__-89"><a href="#SpectralClusterer.__init__-89"><span class="linenos"> 89</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">refinement_options</span><span class="p">:</span>
</span><span id="SpectralClusterer.__init__-90"><a href="#SpectralClusterer.__init__-90"><span class="linenos"> 90</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span> <span class="o">=</span> <span class="n">refinement</span><span class="o">.</span><span class="n">RefinementOptions</span><span class="p">()</span>
</span><span id="SpectralClusterer.__init__-91"><a href="#SpectralClusterer.__init__-91"><span class="linenos"> 91</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer.__init__-92"><a href="#SpectralClusterer.__init__-92"><span class="linenos"> 92</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span> <span class="o">=</span> <span class="n">refinement_options</span>
</span><span id="SpectralClusterer.__init__-93"><a href="#SpectralClusterer.__init__-93"><span class="linenos"> 93</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span> <span class="o">=</span> <span class="n">autotune</span>
</span><span id="SpectralClusterer.__init__-94"><a href="#SpectralClusterer.__init__-94"><span class="linenos"> 94</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">fallback_options</span><span class="p">:</span>
</span><span id="SpectralClusterer.__init__-95"><a href="#SpectralClusterer.__init__-95"><span class="linenos"> 95</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span> <span class="o">=</span> <span class="n">fallback_clusterer</span><span class="o">.</span><span class="n">FallbackOptions</span><span class="p">()</span>
</span><span id="SpectralClusterer.__init__-96"><a href="#SpectralClusterer.__init__-96"><span class="linenos"> 96</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer.__init__-97"><a href="#SpectralClusterer.__init__-97"><span class="linenos"> 97</span></a>      <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span> <span class="o">=</span> <span class="n">fallback_options</span>
</span><span id="SpectralClusterer.__init__-98"><a href="#SpectralClusterer.__init__-98"><span class="linenos"> 98</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">laplacian_type</span> <span class="o">=</span> <span class="n">laplacian_type</span>
</span><span id="SpectralClusterer.__init__-99"><a href="#SpectralClusterer.__init__-99"><span class="linenos"> 99</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">row_wise_renorm</span> <span class="o">=</span> <span class="n">row_wise_renorm</span>
</span><span id="SpectralClusterer.__init__-100"><a href="#SpectralClusterer.__init__-100"><span class="linenos">100</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">stop_eigenvalue</span> <span class="o">=</span> <span class="n">stop_eigenvalue</span>
</span><span id="SpectralClusterer.__init__-101"><a href="#SpectralClusterer.__init__-101"><span class="linenos">101</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">custom_dist</span> <span class="o">=</span> <span class="n">custom_dist</span>
</span><span id="SpectralClusterer.__init__-102"><a href="#SpectralClusterer.__init__-102"><span class="linenos">102</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span> <span class="o">=</span> <span class="n">max_iter</span>
</span><span id="SpectralClusterer.__init__-103"><a href="#SpectralClusterer.__init__-103"><span class="linenos">103</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span> <span class="o">=</span> <span class="n">constraint_options</span>
</span><span id="SpectralClusterer.__init__-104"><a href="#SpectralClusterer.__init__-104"><span class="linenos">104</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">eigengap_type</span> <span class="o">=</span> <span class="n">eigengap_type</span>
</span><span id="SpectralClusterer.__init__-105"><a href="#SpectralClusterer.__init__-105"><span class="linenos">105</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">=</span> <span class="n">max_spectral_size</span>
</span><span id="SpectralClusterer.__init__-106"><a href="#SpectralClusterer.__init__-106"><span class="linenos">106</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">affinity_function</span> <span class="o">=</span> <span class="n">affinity_function</span>
</span><span id="SpectralClusterer.__init__-107"><a href="#SpectralClusterer.__init__-107"><span class="linenos">107</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">post_eigen_cluster_function</span> <span class="o">=</span> <span class="n">post_eigen_cluster_function</span>
</span></pre></div>


            <div class="docstring"><p>Constructor of the clusterer.</p>

<p>Args:
  min_clusters: minimal number of clusters allowed (only effective if not
    None)
  max_clusters: maximal number of clusters allowed (only effective if not
    None), can be used together with min_clusters to fix the number of
    clusters
  refinement_options: a RefinementOptions object that contains refinement
    arguments for the affinity matrix. If None, we will not refine
  autotune: an AutoTune object to automatically search p_percentile
  fallback_options: a FallbackOptions object to indicate when to run
    fallback clusterer instead of spectral clusterer
  laplacian_type: a LaplacianType. If None, we do not use a laplacian matrix
  stop_eigenvalue: when computing the number of clusters using Eigen Gap, we
    do not look at eigen values smaller than this value
  row_wise_renorm: if True, perform row-wise re-normalization on the
    spectral embeddings
  custom_dist: str or callable. custom distance measure for k-means. If a
    string, "cosine", "euclidean", "mahalanobis", or any other distance
    functions defined in scipy.spatial.distance can be used
  max_iter: the maximum number of iterations for the custom k-means
  constraint_options: a ConstraintOptions object that contains constraint
    arguments
  eigengap_type: the type of the eigengap computation
  max_spectral_size: the maximal size of input to the spectral clustering
    algorithm. If this is set, and the actual input size is larger than
    this value, then we are going to first use hierarchical clustering
    to reduce the input size to this number. This can significantly reduce
    the computational cost for steps like Laplacian matrix and eigen
    decomposition. However, please note that this may degrade the quality
    of the final clustering results. This corresponds to the U1 value in
    the multi-stage clustering paper (<a href="https://arxiv.org/abs/2210.13690">https://arxiv.org/abs/2210.13690</a>)
  affinity_function: a function to compute the affinity matrix from the
    embeddings. This defaults to (cos(x,y)+1)/2
  post_eigen_cluster_function: a function to cluster the spectral embeddings
    after the eigenvalue computations. This function must have the same
    signature as custom_distance_kmeans.run_kmeans</p>
</div>


                            </div>
                            <div id="SpectralClusterer.min_clusters" class="classattr">
                                <div class="attr variable">
            <span class="name">min_clusters</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.min_clusters"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.max_clusters" class="classattr">
                                <div class="attr variable">
            <span class="name">max_clusters</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.max_clusters"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.autotune" class="classattr">
                                <div class="attr variable">
            <span class="name">autotune</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.autotune"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.laplacian_type" class="classattr">
                                <div class="attr variable">
            <span class="name">laplacian_type</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.laplacian_type"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.row_wise_renorm" class="classattr">
                                <div class="attr variable">
            <span class="name">row_wise_renorm</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.row_wise_renorm"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.stop_eigenvalue" class="classattr">
                                <div class="attr variable">
            <span class="name">stop_eigenvalue</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.stop_eigenvalue"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.custom_dist" class="classattr">
                                <div class="attr variable">
            <span class="name">custom_dist</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.custom_dist"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.max_iter" class="classattr">
                                <div class="attr variable">
            <span class="name">max_iter</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.max_iter"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.constraint_options" class="classattr">
                                <div class="attr variable">
            <span class="name">constraint_options</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.constraint_options"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.eigengap_type" class="classattr">
                                <div class="attr variable">
            <span class="name">eigengap_type</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.eigengap_type"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.max_spectral_size" class="classattr">
                                <div class="attr variable">
            <span class="name">max_spectral_size</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.max_spectral_size"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.affinity_function" class="classattr">
                                <div class="attr variable">
            <span class="name">affinity_function</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.affinity_function"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.post_eigen_cluster_function" class="classattr">
                                <div class="attr variable">
            <span class="name">post_eigen_cluster_function</span>

        
    </div>
    <a class="headerlink" href="#SpectralClusterer.post_eigen_cluster_function"></a>
    
    

                            </div>
                            <div id="SpectralClusterer.predict" class="classattr">
                                        <input id="SpectralClusterer.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">embeddings</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">constraint_matrix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>:</span></span>

                <label class="view-source-button" for="SpectralClusterer.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SpectralClusterer.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SpectralClusterer.predict-202"><a href="#SpectralClusterer.predict-202"><span class="linenos">202</span></a>  <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-203"><a href="#SpectralClusterer.predict-203"><span class="linenos">203</span></a>      <span class="bp">self</span><span class="p">,</span>
</span><span id="SpectralClusterer.predict-204"><a href="#SpectralClusterer.predict-204"><span class="linenos">204</span></a>      <span class="n">embeddings</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
</span><span id="SpectralClusterer.predict-205"><a href="#SpectralClusterer.predict-205"><span class="linenos">205</span></a>      <span class="n">constraint_matrix</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-206"><a href="#SpectralClusterer.predict-206"><span class="linenos">206</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform spectral clustering on data embeddings.</span>
</span><span id="SpectralClusterer.predict-207"><a href="#SpectralClusterer.predict-207"><span class="linenos">207</span></a>
</span><span id="SpectralClusterer.predict-208"><a href="#SpectralClusterer.predict-208"><span class="linenos">208</span></a><span class="sd">    The spectral clustering is performed on an affinity matrix.</span>
</span><span id="SpectralClusterer.predict-209"><a href="#SpectralClusterer.predict-209"><span class="linenos">209</span></a>
</span><span id="SpectralClusterer.predict-210"><a href="#SpectralClusterer.predict-210"><span class="linenos">210</span></a><span class="sd">    Args:</span>
</span><span id="SpectralClusterer.predict-211"><a href="#SpectralClusterer.predict-211"><span class="linenos">211</span></a><span class="sd">      embeddings: numpy array of shape (n_samples, n_features)</span>
</span><span id="SpectralClusterer.predict-212"><a href="#SpectralClusterer.predict-212"><span class="linenos">212</span></a><span class="sd">      constraint_matrix: numpy array of shape (n_samples, n_samples). The</span>
</span><span id="SpectralClusterer.predict-213"><a href="#SpectralClusterer.predict-213"><span class="linenos">213</span></a><span class="sd">        constraint matrix with prior information</span>
</span><span id="SpectralClusterer.predict-214"><a href="#SpectralClusterer.predict-214"><span class="linenos">214</span></a>
</span><span id="SpectralClusterer.predict-215"><a href="#SpectralClusterer.predict-215"><span class="linenos">215</span></a><span class="sd">    Returns:</span>
</span><span id="SpectralClusterer.predict-216"><a href="#SpectralClusterer.predict-216"><span class="linenos">216</span></a><span class="sd">      labels: numpy array of shape (n_samples,)</span>
</span><span id="SpectralClusterer.predict-217"><a href="#SpectralClusterer.predict-217"><span class="linenos">217</span></a>
</span><span id="SpectralClusterer.predict-218"><a href="#SpectralClusterer.predict-218"><span class="linenos">218</span></a><span class="sd">    Raises:</span>
</span><span id="SpectralClusterer.predict-219"><a href="#SpectralClusterer.predict-219"><span class="linenos">219</span></a><span class="sd">      TypeError: if embeddings has wrong type</span>
</span><span id="SpectralClusterer.predict-220"><a href="#SpectralClusterer.predict-220"><span class="linenos">220</span></a><span class="sd">      ValueError: if embeddings has wrong shape</span>
</span><span id="SpectralClusterer.predict-221"><a href="#SpectralClusterer.predict-221"><span class="linenos">221</span></a><span class="sd">      RuntimeError: if max_spectral_size is set and constraint_matrix is given</span>
</span><span id="SpectralClusterer.predict-222"><a href="#SpectralClusterer.predict-222"><span class="linenos">222</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SpectralClusterer.predict-223"><a href="#SpectralClusterer.predict-223"><span class="linenos">223</span></a>    <span class="n">num_embeddings</span> <span class="o">=</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SpectralClusterer.predict-224"><a href="#SpectralClusterer.predict-224"><span class="linenos">224</span></a>
</span><span id="SpectralClusterer.predict-225"><a href="#SpectralClusterer.predict-225"><span class="linenos">225</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">embeddings</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="SpectralClusterer.predict-226"><a href="#SpectralClusterer.predict-226"><span class="linenos">226</span></a>      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;embeddings must be a numpy array&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-227"><a href="#SpectralClusterer.predict-227"><span class="linenos">227</span></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">embeddings</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-228"><a href="#SpectralClusterer.predict-228"><span class="linenos">228</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;embeddings must be 2-dimensional&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-229"><a href="#SpectralClusterer.predict-229"><span class="linenos">229</span></a>
</span><span id="SpectralClusterer.predict-230"><a href="#SpectralClusterer.predict-230"><span class="linenos">230</span></a>    <span class="c1"># Check whether we need to run fallback clusterer instead.</span>
</span><span id="SpectralClusterer.predict-231"><a href="#SpectralClusterer.predict-231"><span class="linenos">231</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">num_embeddings</span> <span class="o">&lt;</span>
</span><span id="SpectralClusterer.predict-232"><a href="#SpectralClusterer.predict-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span><span class="o">.</span><span class="n">spectral_min_embeddings</span><span class="p">):</span>
</span><span id="SpectralClusterer.predict-233"><a href="#SpectralClusterer.predict-233"><span class="linenos">233</span></a>      <span class="n">temp_clusterer</span> <span class="o">=</span> <span class="n">fallback_clusterer</span><span class="o">.</span><span class="n">FallbackClusterer</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-234"><a href="#SpectralClusterer.predict-234"><span class="linenos">234</span></a>          <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-235"><a href="#SpectralClusterer.predict-235"><span class="linenos">235</span></a>      <span class="k">return</span> <span class="n">temp_clusterer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-236"><a href="#SpectralClusterer.predict-236"><span class="linenos">236</span></a>
</span><span id="SpectralClusterer.predict-237"><a href="#SpectralClusterer.predict-237"><span class="linenos">237</span></a>    <span class="c1"># Check whether the input size is too big for running spectral clustering.</span>
</span><span id="SpectralClusterer.predict-238"><a href="#SpectralClusterer.predict-238"><span class="linenos">238</span></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="SpectralClusterer.predict-239"><a href="#SpectralClusterer.predict-239"><span class="linenos">239</span></a>        <span class="ow">and</span> <span class="n">num_embeddings</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span><span class="p">):</span>
</span><span id="SpectralClusterer.predict-240"><a href="#SpectralClusterer.predict-240"><span class="linenos">240</span></a>      <span class="k">if</span> <span class="n">constraint_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-241"><a href="#SpectralClusterer.predict-241"><span class="linenos">241</span></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-242"><a href="#SpectralClusterer.predict-242"><span class="linenos">242</span></a>            <span class="s2">&quot;Cannot handle constraint_matrix when max_spectral_size is set&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-243"><a href="#SpectralClusterer.predict-243"><span class="linenos">243</span></a>      <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span>
</span><span id="SpectralClusterer.predict-244"><a href="#SpectralClusterer.predict-244"><span class="linenos">244</span></a>         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_clusters</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="SpectralClusterer.predict-245"><a href="#SpectralClusterer.predict-245"><span class="linenos">245</span></a>         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_spectral_size</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span><span class="p">)):</span>
</span><span id="SpectralClusterer.predict-246"><a href="#SpectralClusterer.predict-246"><span class="linenos">246</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-247"><a href="#SpectralClusterer.predict-247"><span class="linenos">247</span></a>            <span class="s2">&quot;max_spectral_size should be a relatively big number&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-248"><a href="#SpectralClusterer.predict-248"><span class="linenos">248</span></a>      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reduce_size_and_predict</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-249"><a href="#SpectralClusterer.predict-249"><span class="linenos">249</span></a>
</span><span id="SpectralClusterer.predict-250"><a href="#SpectralClusterer.predict-250"><span class="linenos">250</span></a>    <span class="c1"># Compute affinity matrix.</span>
</span><span id="SpectralClusterer.predict-251"><a href="#SpectralClusterer.predict-251"><span class="linenos">251</span></a>    <span class="n">affinity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">affinity_function</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-252"><a href="#SpectralClusterer.predict-252"><span class="linenos">252</span></a>
</span><span id="SpectralClusterer.predict-253"><a href="#SpectralClusterer.predict-253"><span class="linenos">253</span></a>    <span class="c1"># Make single-vs-multi cluster(s) decision.</span>
</span><span id="SpectralClusterer.predict-254"><a href="#SpectralClusterer.predict-254"><span class="linenos">254</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-255"><a href="#SpectralClusterer.predict-255"><span class="linenos">255</span></a>      <span class="k">if</span> <span class="n">fallback_clusterer</span><span class="o">.</span><span class="n">check_single_cluster</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-256"><a href="#SpectralClusterer.predict-256"><span class="linenos">256</span></a>              <span class="bp">self</span><span class="o">.</span><span class="n">fallback_options</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">,</span> <span class="n">affinity</span><span class="p">):</span>
</span><span id="SpectralClusterer.predict-257"><a href="#SpectralClusterer.predict-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_embeddings</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-258"><a href="#SpectralClusterer.predict-258"><span class="linenos">258</span></a>
</span><span id="SpectralClusterer.predict-259"><a href="#SpectralClusterer.predict-259"><span class="linenos">259</span></a>    <span class="c1"># Apply constraint.</span>
</span><span id="SpectralClusterer.predict-260"><a href="#SpectralClusterer.predict-260"><span class="linenos">260</span></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span> <span class="ow">and</span>
</span><span id="SpectralClusterer.predict-261"><a href="#SpectralClusterer.predict-261"><span class="linenos">261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span><span class="o">.</span><span class="n">apply_before_refinement</span> <span class="ow">and</span>
</span><span id="SpectralClusterer.predict-262"><a href="#SpectralClusterer.predict-262"><span class="linenos">262</span></a>        <span class="n">constraint_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="SpectralClusterer.predict-263"><a href="#SpectralClusterer.predict-263"><span class="linenos">263</span></a>      <span class="c1"># Perform the constraint operation before refinement</span>
</span><span id="SpectralClusterer.predict-264"><a href="#SpectralClusterer.predict-264"><span class="linenos">264</span></a>      <span class="n">affinity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint_options</span><span class="o">.</span><span class="n">constraint_operator</span><span class="o">.</span><span class="n">adjust_affinity</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-265"><a href="#SpectralClusterer.predict-265"><span class="linenos">265</span></a>          <span class="n">affinity</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-266"><a href="#SpectralClusterer.predict-266"><span class="linenos">266</span></a>
</span><span id="SpectralClusterer.predict-267"><a href="#SpectralClusterer.predict-267"><span class="linenos">267</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-268"><a href="#SpectralClusterer.predict-268"><span class="linenos">268</span></a>      <span class="c1"># Use Auto-tuning method to find a good p_percentile.</span>
</span><span id="SpectralClusterer.predict-269"><a href="#SpectralClusterer.predict-269"><span class="linenos">269</span></a>      <span class="k">if</span> <span class="p">(</span><span class="n">RefinementName</span><span class="o">.</span><span class="n">RowWiseThreshold</span>
</span><span id="SpectralClusterer.predict-270"><a href="#SpectralClusterer.predict-270"><span class="linenos">270</span></a>          <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span><span class="o">.</span><span class="n">refinement_sequence</span><span class="p">):</span>
</span><span id="SpectralClusterer.predict-271"><a href="#SpectralClusterer.predict-271"><span class="linenos">271</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-272"><a href="#SpectralClusterer.predict-272"><span class="linenos">272</span></a>            <span class="s2">&quot;AutoTune is only effective when the refinement sequence&quot;</span>
</span><span id="SpectralClusterer.predict-273"><a href="#SpectralClusterer.predict-273"><span class="linenos">273</span></a>            <span class="s2">&quot;contains RowWiseThreshold&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-274"><a href="#SpectralClusterer.predict-274"><span class="linenos">274</span></a>
</span><span id="SpectralClusterer.predict-275"><a href="#SpectralClusterer.predict-275"><span class="linenos">275</span></a>      <span class="k">def</span> <span class="nf">p_percentile_to_ratio</span><span class="p">(</span><span class="n">p_percentile</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span>
</span><span id="SpectralClusterer.predict-276"><a href="#SpectralClusterer.predict-276"><span class="linenos">276</span></a>          <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
</span><span id="SpectralClusterer.predict-277"><a href="#SpectralClusterer.predict-277"><span class="linenos">277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the `ratio` given a `p_percentile` value.&quot;&quot;&quot;</span>
</span><span id="SpectralClusterer.predict-278"><a href="#SpectralClusterer.predict-278"><span class="linenos">278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refinement_options</span><span class="o">.</span><span class="n">p_percentile</span> <span class="o">=</span> <span class="n">p_percentile</span>
</span><span id="SpectralClusterer.predict-279"><a href="#SpectralClusterer.predict-279"><span class="linenos">279</span></a>        <span class="p">(</span><span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span>
</span><span id="SpectralClusterer.predict-280"><a href="#SpectralClusterer.predict-280"><span class="linenos">280</span></a>         <span class="n">max_delta_norm</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_eigenvectors_ncluster</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-281"><a href="#SpectralClusterer.predict-281"><span class="linenos">281</span></a>             <span class="n">affinity</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-282"><a href="#SpectralClusterer.predict-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="o">.</span><span class="n">proxy</span> <span class="o">==</span> <span class="n">AutoTuneProxy</span><span class="o">.</span><span class="n">PercentileSqrtOverNME</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-283"><a href="#SpectralClusterer.predict-283"><span class="linenos">283</span></a>          <span class="n">ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_percentile</span><span class="p">)</span> <span class="o">/</span> <span class="n">max_delta_norm</span>
</span><span id="SpectralClusterer.predict-284"><a href="#SpectralClusterer.predict-284"><span class="linenos">284</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="o">.</span><span class="n">proxy</span> <span class="o">==</span> <span class="n">AutoTuneProxy</span><span class="o">.</span><span class="n">PercentileSqrtOverNME</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-285"><a href="#SpectralClusterer.predict-285"><span class="linenos">285</span></a>          <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_percentile</span><span class="p">)</span> <span class="o">/</span> <span class="n">max_delta_norm</span>
</span><span id="SpectralClusterer.predict-286"><a href="#SpectralClusterer.predict-286"><span class="linenos">286</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-287"><a href="#SpectralClusterer.predict-287"><span class="linenos">287</span></a>          <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported value of AutoTuneProxy&quot;</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-288"><a href="#SpectralClusterer.predict-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span>
</span><span id="SpectralClusterer.predict-289"><a href="#SpectralClusterer.predict-289"><span class="linenos">289</span></a>
</span><span id="SpectralClusterer.predict-290"><a href="#SpectralClusterer.predict-290"><span class="linenos">290</span></a>      <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autotune</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">p_percentile_to_ratio</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-291"><a href="#SpectralClusterer.predict-291"><span class="linenos">291</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-292"><a href="#SpectralClusterer.predict-292"><span class="linenos">292</span></a>      <span class="c1"># Do not use Auto-tune.</span>
</span><span id="SpectralClusterer.predict-293"><a href="#SpectralClusterer.predict-293"><span class="linenos">293</span></a>      <span class="n">eigenvectors</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_eigenvectors_ncluster</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-294"><a href="#SpectralClusterer.predict-294"><span class="linenos">294</span></a>          <span class="n">affinity</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-295"><a href="#SpectralClusterer.predict-295"><span class="linenos">295</span></a>
</span><span id="SpectralClusterer.predict-296"><a href="#SpectralClusterer.predict-296"><span class="linenos">296</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-297"><a href="#SpectralClusterer.predict-297"><span class="linenos">297</span></a>      <span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_clusters</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-298"><a href="#SpectralClusterer.predict-298"><span class="linenos">298</span></a>
</span><span id="SpectralClusterer.predict-299"><a href="#SpectralClusterer.predict-299"><span class="linenos">299</span></a>    <span class="c1"># Get spectral embeddings.</span>
</span><span id="SpectralClusterer.predict-300"><a href="#SpectralClusterer.predict-300"><span class="linenos">300</span></a>    <span class="n">spectral_embeddings</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_clusters</span><span class="p">]</span>
</span><span id="SpectralClusterer.predict-301"><a href="#SpectralClusterer.predict-301"><span class="linenos">301</span></a>
</span><span id="SpectralClusterer.predict-302"><a href="#SpectralClusterer.predict-302"><span class="linenos">302</span></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_wise_renorm</span><span class="p">:</span>
</span><span id="SpectralClusterer.predict-303"><a href="#SpectralClusterer.predict-303"><span class="linenos">303</span></a>      <span class="c1"># Perform row wise re-normalization.</span>
</span><span id="SpectralClusterer.predict-304"><a href="#SpectralClusterer.predict-304"><span class="linenos">304</span></a>      <span class="n">rows_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">spectral_embeddings</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-305"><a href="#SpectralClusterer.predict-305"><span class="linenos">305</span></a>      <span class="n">spectral_embeddings</span> <span class="o">=</span> <span class="n">spectral_embeddings</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-306"><a href="#SpectralClusterer.predict-306"><span class="linenos">306</span></a>          <span class="n">rows_norm</span><span class="p">,</span> <span class="p">(</span><span class="n">num_embeddings</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="SpectralClusterer.predict-307"><a href="#SpectralClusterer.predict-307"><span class="linenos">307</span></a>
</span><span id="SpectralClusterer.predict-308"><a href="#SpectralClusterer.predict-308"><span class="linenos">308</span></a>    <span class="c1"># Run clustering algorithm on spectral embeddings. This defaults</span>
</span><span id="SpectralClusterer.predict-309"><a href="#SpectralClusterer.predict-309"><span class="linenos">309</span></a>    <span class="c1"># to customized K-means.</span>
</span><span id="SpectralClusterer.predict-310"><a href="#SpectralClusterer.predict-310"><span class="linenos">310</span></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">post_eigen_cluster_function</span><span class="p">(</span>
</span><span id="SpectralClusterer.predict-311"><a href="#SpectralClusterer.predict-311"><span class="linenos">311</span></a>        <span class="n">spectral_embeddings</span><span class="o">=</span><span class="n">spectral_embeddings</span><span class="p">,</span>
</span><span id="SpectralClusterer.predict-312"><a href="#SpectralClusterer.predict-312"><span class="linenos">312</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="SpectralClusterer.predict-313"><a href="#SpectralClusterer.predict-313"><span class="linenos">313</span></a>        <span class="n">custom_dist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_dist</span><span class="p">,</span>
</span><span id="SpectralClusterer.predict-314"><a href="#SpectralClusterer.predict-314"><span class="linenos">314</span></a>        <span class="n">max_iter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iter</span><span class="p">)</span>
</span><span id="SpectralClusterer.predict-315"><a href="#SpectralClusterer.predict-315"><span class="linenos">315</span></a>    <span class="k">return</span> <span class="n">labels</span>
</span></pre></div>


            <div class="docstring"><p>Perform spectral clustering on data embeddings.</p>

<p>The spectral clustering is performed on an affinity matrix.</p>

<p>Args:
  embeddings: numpy array of shape (n_samples, n_features)
  constraint_matrix: numpy array of shape (n_samples, n_samples). The
    constraint matrix with prior information</p>

<p>Returns:
  labels: numpy array of shape (n_samples,)</p>

<p>Raises:
  TypeError: if embeddings has wrong type
  ValueError: if embeddings has wrong shape
  RuntimeError: if max_spectral_size is set and constraint_matrix is given</p>
</div>


                            </div>
                </section>
                <section id="ICASSP2018_REFINEMENT_SEQUENCE">
                    <div class="attr variable">
            <span class="name">ICASSP2018_REFINEMENT_SEQUENCE</span>        =
<input id="ICASSP2018_REFINEMENT_SEQUENCE-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="ICASSP2018_REFINEMENT_SEQUENCE-view-value"></label><span class="default_value">[&lt;<a href="#RefinementName.CropDiagonal">RefinementName.CropDiagonal</a>: 1&gt;, &lt;<a href="#RefinementName.GaussianBlur">RefinementName.GaussianBlur</a>: 2&gt;, &lt;<a href="#RefinementName.RowWiseThreshold">RefinementName.RowWiseThreshold</a>: 3&gt;, &lt;<a href="#RefinementName.Symmetrize">RefinementName.Symmetrize</a>: 4&gt;, &lt;<a href="#RefinementName.Diffuse">RefinementName.Diffuse</a>: 5&gt;, &lt;<a href="#RefinementName.RowWiseNormalize">RefinementName.RowWiseNormalize</a>: 6&gt;]</span>

        
    </div>
    <a class="headerlink" href="#ICASSP2018_REFINEMENT_SEQUENCE"></a>
    
    

                </section>
                <section id="icassp2018_refinement_options">
                    <div class="attr variable">
            <span class="name">icassp2018_refinement_options</span>        =
<input id="icassp2018_refinement_options-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="icassp2018_refinement_options-view-value"></label><span class="default_value">RefinementOptions(gaussian_blur_sigma=1, p_percentile=0.95, thresholding_soft_multiplier=0.01, thresholding_type=&lt;<a href="#ThresholdType.RowMax">ThresholdType.RowMax</a>: 1&gt;, thresholding_with_binarization=False, thresholding_preserve_diagonal=False, symmetrize_type=&lt;<a href="#SymmetrizeType.Max">SymmetrizeType.Max</a>: 1&gt;, refinement_sequence=[&lt;<a href="#RefinementName.CropDiagonal">RefinementName.CropDiagonal</a>: 1&gt;, &lt;<a href="#RefinementName.GaussianBlur">RefinementName.GaussianBlur</a>: 2&gt;, &lt;<a href="#RefinementName.RowWiseThreshold">RefinementName.RowWiseThreshold</a>: 3&gt;, &lt;<a href="#RefinementName.Symmetrize">RefinementName.Symmetrize</a>: 4&gt;, &lt;<a href="#RefinementName.Diffuse">RefinementName.Diffuse</a>: 5&gt;, &lt;<a href="#RefinementName.RowWiseNormalize">RefinementName.RowWiseNormalize</a>: 6&gt;])</span>

        
    </div>
    <a class="headerlink" href="#icassp2018_refinement_options"></a>
    
    

                </section>
                <section id="icassp2018_clusterer">
                    <div class="attr variable">
            <span class="name">icassp2018_clusterer</span>        =
<span class="default_value">&lt;<a href="#SpectralClusterer">spectralcluster.configs.SpectralClusterer</a> object&gt;</span>

        
    </div>
    <a class="headerlink" href="#icassp2018_clusterer"></a>
    
    

                </section>
                <section id="TURNTODIARIZE_REFINEMENT_SEQUENCE">
                    <div class="attr variable">
            <span class="name">TURNTODIARIZE_REFINEMENT_SEQUENCE</span>        =
<span class="default_value">[&lt;<a href="#RefinementName.RowWiseThreshold">RefinementName.RowWiseThreshold</a>: 3&gt;, &lt;<a href="#RefinementName.Symmetrize">RefinementName.Symmetrize</a>: 4&gt;]</span>

        
    </div>
    <a class="headerlink" href="#TURNTODIARIZE_REFINEMENT_SEQUENCE"></a>
    
    

                </section>
                <section id="turntodiarize_refinement_options">
                    <div class="attr variable">
            <span class="name">turntodiarize_refinement_options</span>        =
<input id="turntodiarize_refinement_options-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="turntodiarize_refinement_options-view-value"></label><span class="default_value">RefinementOptions(gaussian_blur_sigma=1, p_percentile=0.95, thresholding_soft_multiplier=0.01, thresholding_type=&lt;<a href="#ThresholdType.Percentile">ThresholdType.Percentile</a>: 2&gt;, thresholding_with_binarization=True, thresholding_preserve_diagonal=True, symmetrize_type=&lt;<a href="#SymmetrizeType.Average">SymmetrizeType.Average</a>: 2&gt;, refinement_sequence=[&lt;<a href="#RefinementName.RowWiseThreshold">RefinementName.RowWiseThreshold</a>: 3&gt;, &lt;<a href="#RefinementName.Symmetrize">RefinementName.Symmetrize</a>: 4&gt;])</span>

        
    </div>
    <a class="headerlink" href="#turntodiarize_refinement_options"></a>
    
    

                </section>
                <section id="turntodiarize_constraint_options">
                    <div class="attr variable">
            <span class="name">turntodiarize_constraint_options</span>        =
<input id="turntodiarize_constraint_options-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="turntodiarize_constraint_options-view-value"></label><span class="default_value">ConstraintOptions(constraint_name=&lt;<a href="#ConstraintName.ConstraintPropagation">ConstraintName.ConstraintPropagation</a>: 2&gt;, apply_before_refinement=True, integration_type=None, constraint_propagation_alpha=0.4)</span>

        
    </div>
    <a class="headerlink" href="#turntodiarize_constraint_options"></a>
    
    

                </section>
                <section id="turntodiarize_auto_tune">
                    <div class="attr variable">
            <span class="name">turntodiarize_auto_tune</span>        =
<span class="default_value">&lt;<a href="#AutoTune">spectralcluster.configs.AutoTune</a> object&gt;</span>

        
    </div>
    <a class="headerlink" href="#turntodiarize_auto_tune"></a>
    
    

                </section>
                <section id="turntodiarize_clusterer">
                    <div class="attr variable">
            <span class="name">turntodiarize_clusterer</span>        =
<span class="default_value">&lt;<a href="#SpectralClusterer">spectralcluster.configs.SpectralClusterer</a> object&gt;</span>

        
    </div>
    <a class="headerlink" href="#turntodiarize_clusterer"></a>
    
    

                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>